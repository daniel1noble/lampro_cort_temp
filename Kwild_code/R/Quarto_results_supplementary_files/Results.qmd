---
title: "Results"
format:
  docx:
    reference-doc: ../../bib/template.docx
editor_options: 
  chunk_output_type: console
execute:
  freeze: auto  # re-render only when source changes
  cache: false
  echo: false
  warning: false
  error: false
  include: true
crossref:
  fig-title: 'Figure'
  fig-labels: arabic
  title-delim: "-"
  fig-prefix: "Figure"
  tbl-prefix: "Table"
---

```{r setup, include=FALSE, eval = T, echo = FALSE}
## Packages and set up
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(message = FALSE)
options(digits = 3)
rm(list=ls())
sessionInfo()
pacman::p_load(dplyr, flextable, knitr, here, dplyr, tidyverse, ggpubr, lme4, emmeans, car, lmerTest, lubridate, performance, cowplot, interp, ggpubr, ggplot2, stats, rotl, dplyr, viridis, patchwork, interp, akima, fields, MASS)
```
### *a) The effects of developmental treatments (temperature, and CORT) on hatchling prototypes*

```{r}
#| echo: false

##### data used in analysis
final_analysis_data <- read.csv(here("Kwild_code/data/final_analysis_data_quarto.csv"))
# sample size
n_all <- final_analysis_data %>% 
  summarise(sample_size = n_distinct(Lizard_ID))
n_temp_horm_trt <- final_analysis_data %>%
  group_by(as.character(temp), hormone) %>% 
  summarise(n = n())
n_temp_trt <- final_analysis_data %>%
  group_by(as.character(temp)) %>% 
  summarise(n = n())  
n_horm_trt <- final_analysis_data %>%
  group_by(hormone) %>% 
  summarise(n = n())  



################
#### 1.	What are the effects of developmental treatments (temp, cort, interaction) on time to hatch?
#### effect of temperature on incubation days - faster hatch warmer temps 
################
# mod ; interaction removed
hatch_dev_mod <- readRDS(here("Kwild_code/models/hatch_dev_mod.RDS"))
hatch_dev_mod_summ <- summary(hatch_dev_mod)
hatch_dev_mod_summ <- as.data.frame(round(hatch_dev_mod_summ$coefficients, 
                                          digits = 2))
hatch_dev_mod_anova <- as.data.frame(anova(hatch_dev_mod)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))

# faster hatch warmer temps
hatch_dev_mod_emm <- emmeans(hatch_dev_mod, pairwise ~ temp)
hatch_dev_mod_emm_value <- as.data.frame(hatch_dev_mod_emm$emmeans) %>% 
  mutate(emmean = round(emmean, digits = 1),
         SE = round(SE, digits = 2),
         LCL = round(lower.CL, digits = 2),
         UCL = round(upper.CL, digits = 2))
hatch_dev_mod_emm_cont <- hatch_dev_mod_emm$contrasts



################
#### 2.	What are the effects of developmental treatments on body size, mass, and condition (BCI) of HATCHLINGS
#### SVL: hormone effects body size; no interaction effects
#### MASS: temperature and hormone effects mass; no interaction effects
#### BCI:  temperature has effect on BCI; no effect on hormone; no interaction effects
################
#### SVL; interaction removed
# hormone effects body size; no effects on temp or no interaction effects
SVL_hatch_mod <- readRDS(here("Kwild_code/models/SVL_hatch_mod.RDS"))
SVL_hatch_mod_summ <- summary(SVL_hatch_mod)
SVL_hatch_mod_summ <- as.data.frame(round(SVL_hatch_mod_summ$coefficients, 
                                          digits = 2))
SVL_hatch_mod_anova <- as.data.frame(anova(SVL_hatch_mod)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))
# high hormone lower SVL
SVL_hatch_mod_emm <- emmeans(SVL_hatch_mod, pairwise ~ hormone)
SVL_hatch_mod_emm_value <- SVL_hatch_mod_emm$emmeans
SVL_hatch_mod_emm_cont <- SVL_hatch_mod_emm$contrasts

################
#### MASS; interaction removed
Mass_hatch_mod <- readRDS(here("Kwild_code/models/MASS_hatch_mod.RDS"))
# temperature and hormone effects mass; no interaction effects
Mass_hatch_mod_summ <- summary(Mass_hatch_mod)
Mass_hatch_mod_summ <- as.data.frame(round(Mass_hatch_mod_summ$coefficients, 
                                          digits = 2))
Mass_hatch_mod_anova <- as.data.frame(anova(Mass_hatch_mod)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))
# hormone pairwise comparison - control higher mass
Mass_hormone_hatch_mod_emm <- emmeans(Mass_hatch_mod, pairwise ~ hormone)
Mass_hormone_hatch_mod_emm_value <- Mass_hormone_hatch_mod_emm$emmeans
Mass_hormone_hatch_mod_emm_cont <- Mass_hormone_hatch_mod_emm$contrasts
# temp pairwise comparison - cooler temps higher mass
Mass_temp_hatch_mod_emm <- emmeans(Mass_hatch_mod, pairwise ~ temp)
Mass_temp_hatch_mod_emm_value <- Mass_temp_hatch_mod_emm$emmeans
Mass_temp_hatch_mod_emm_cont <- Mass_temp_hatch_mod_emm$contrasts

################
#### BCI from residuals (OLS); interaction removed
# hatchlings- residuals from SVL and mass
## hatchlings-anova on BCI residuals; interaction removed
condition_hatch_mod <- readRDS(here("Kwild_code/models/condition_hatch_mod.RDS"))
# temperature has effect on BCI; no effect on hormone, or temp x hormone interaction
condition_hatch_mod_summ <- summary(condition_hatch_mod)
condition_hatch_mod_summ <- as.data.frame(round(condition_hatch_mod_summ$coefficients, 
                                          digits = 2))
condition_hatch_mod_anova <- as.data.frame(anova(condition_hatch_mod)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))
# temp and BCI plot - poor BCI warm temps
condition_hatch_mod_emm <- emmeans(condition_hatch_mod, pairwise ~ temp)
condition_hatch_mod_emm_value <- condition_hatch_mod_emm$emmeans
condition_hatch_mod_emm_value <- condition_hatch_mod_emm$contrasts
```

A total of `r n_all[1,1]` eggs were randomly allocated into two incubation treatments (cold 23ºC n = `r n_temp_trt[1,2]`; hot 28ºC n = `r n_temp_trt[2,2]`). Within each temperature treatment, eggs were then randomly allocated into their hormone treatment (control n = `r n_horm_trt[1,2]`; low n = `r n_horm_trt[3,2]`; high n = `r n_horm_trt[2,2]`). Overall, there was no effect on hormonal treatment on developmental time to hatch (F$_{2,116}$ = `r hatch_dev_mod_anova[2,4]`, p = `r hatch_dev_mod_anova[2,5]`), but as expected, developmental temperature significantly increased rate of developmental time (F$_{1,117}$ = `r hatch_dev_mod_anova[1,4]`, p = `r hatch_dev_mod_anova[1,5]`; Figure S1). On average, the incubation duration for the hot treatment was `r hatch_dev_mod_emm_value[1,2]` days (`r hatch_dev_mod_emm_value[1,3]`±SE) and`r hatch_dev_mod_emm_value[2,2]` days (`r hatch_dev_mod_emm_value[2,3]`±SE). High hormonal treatment significantly decreased hatchling mass (F$_{1,125}$ = `r Mass_hatch_mod_anova[2,4]`, p = `r Mass_hatch_mod_anova[2,5]`) and SVL (F$_{1,125}$ = `r SVL_hatch_mod_anova[2,4]`, p = `r SVL_hatch_mod_anova[2,5]`) in comparison to control treatments (Fig. 1A|B). Additionally high temperature treatment decreased hatchling mass (F$_{1,125}$ = `r Mass_hatch_mod_anova[1,4]`, p = `r Mass_hatch_mod_anova[1,5]`; Fig. 2A) and resulted in poor body condition (F$_{1,125}$ = `r condition_hatch_mod_anova[1,4]`, p = `r condition_hatch_mod_anova[1,5]`; Fig. 2B). Temperature treatment did not have an overall effect on SVL (F$_{1,125}$ = `r SVL_hatch_mod_anova[1,4]`, p = `r SVL_hatch_mod_anova[1,5]`) and hormonal treatment did not effect body condition (F$_{1,125}$ = `r condition_hatch_mod_anova[2,4]`, p = `r condition_hatch_mod_anova[2,5]`).

### *b) The effects of developmental treatments (temperature and CORT) on juvenile Physiology - CORT, T4, and mitochondrial function*
```{r}
#| echo: false
  #### 3.	What are the developmental temperature and hormonal treatment on juvenile CORT, T4, and Testosterone)?
  #### CORT_development: CORT does not vary across temp and hormone treatment - NS
  #### CORT_growth: CORT correlates with mass growth rate 
  #### T4_development: T4 varies across sex but not developmental treatments (temp or hormone)
  #### T4_growth: T4 correlates with mass growth rate 

  # final raw data that have morphometrics (svl, mass, and BCI residuals) across life stage 
  data_final <- read.csv(here("Kwild_code/data/final_analysis_data_quarto.csv")) %>%
  filter(juv3_Sample_volume_ul >= 4 ) # remove values below 4 ul juv3_Sample_volume_ul


  ### individual data
  # cort data  
  cort_dat <- data_final %>%
    drop_na(juv3_CORT_Final_Hormone_ng_mL, temp, hormone, juv3_HandlingTime_sec)
  # T4 data
  t4_dat <- data_final %>%
    drop_na(juv3_T4_corrected_ng_mL, temp, hormone, Lizard_ID) 
  
  # oroboros data
  mito_dat <- data_final %>%
  dplyr::select(c("Lizard_ID", "temp", "hormone", "sex", "juv3_bc_resid",
                  "juv3_inject_time_sec", "juv3_liver_time_sec", "juv3_oroboros", 
                  "juv3_chamber","juv3_basal_corrected.pmol..sec.ng..", 
                  "juv3_adp_corrected.pmol..sec.ng..", "juv3_oligo_corrected.pmol..sec.ng..", 
                  "juv3_fccp_corrected.pmol..sec.ng..", "juv3_RCR.L.R.", "juv3_RCR.R.ETS.",
                  "juv3_oroboros_comments", "juv3_RCR.L.ETS.")) %>% 
  dplyr::rename(inject_time_sec = juv3_inject_time_sec, 
                chamber = juv3_chamber,
                basal_corrected_pmol = juv3_basal_corrected.pmol..sec.ng..,
                oligo_corrected_pmol = juv3_oligo_corrected.pmol..sec.ng..,
                fccp_corrected_pmol = juv3_fccp_corrected.pmol..sec.ng..,
                adp_corrected_pmol =  juv3_adp_corrected.pmol..sec.ng..,
                RCR_L_R = juv3_RCR.L.R., 
                RCR_R_ETS = juv3_RCR.R.ETS.,
                RCR_L_ETS = juv3_RCR.L.ETS., 
                oroboros_comments = juv3_oroboros_comments) %>% 
  mutate(ID_and_Comments = paste(Lizard_ID, oroboros_comments, sep = ": "),
         state2_state3 = basal_corrected_pmol/basal_corrected_pmol)


  ###########
  # CORT
  # 1) treatments- how does cort vary across temp and hormone treatment
  cort_development_mod <- readRDS(here("Kwild_code/models/cort_development_mod.RDS"))
  cort_development_mod_summ <- summary(cort_development_mod)
  cort_development_mod_summ <- as.data.frame(round(cort_development_mod_summ$coefficients, 
                                            digits = 2))

  # 2)  MASS growth - does cort correlate with mass growth rate and how does this vary across temp and hormone treatment
  cort_mass_growth_mod <- readRDS(here("Kwild_code/models/cort_mass_growth_mod.RDS"))
  cort_mass_growth_mod_summ <- summary(cort_mass_growth_mod)
  cort_mass_growth_mod_summ <- as.data.frame(round(cort_mass_growth_mod_summ$coefficients, 
                                            digits = 2))

  ###########
  # T4
  # 1) treatments -  does T4 vary across temp, hormone treatment and sex: Sex differences
  T4_sex_temp_hormone_mod <- readRDS(here("Kwild_code/models/T4_temp_hormone_sex_mod.RDS"))
  T4_sex_temp_hormone_mod_summ <- summary(T4_sex_temp_hormone_mod)
  T4_sex_temp_hormone_mod_summ <- as.data.frame(round(T4_sex_temp_hormone_mod_summ$coefficients, 
                                            digits = 2))
  T4_temp_hormone_sex_mod_emm <- emmeans(T4_sex_temp_hormone_mod, pairwise ~ sex)
  T4_temp_hormone_sex_mod_emm_value <- T4_temp_hormone_sex_mod_emm$emmeans
  T4_temp_hormone_sex_mod_emm_cont <- T4_temp_hormone_sex_mod_emm$contrasts

  # 2) MASS growth and the interaction between T4 and cort
  T4_mass_growth_mod <- readRDS(here("Kwild_code/models/T4_mass_growth_mod.RDS"))
  T4_mass_growth_mod_summ <- summary(T4_mass_growth_mod)
  T4_mass_growth_mod_summ <- as.data.frame(round(T4_mass_growth_mod_summ$coefficients, 
                                            digits = 2))
###########
# Mito function
  
```

### *c) The effects of developmental treatments (temperature and CORT) on juvenile body size, mass, body condition (BCI), survival, and growth rate on juvenile lizards*

```{r}
#| echo: false
#### 3.	What are the effects of developmental treatments on juvenile body size, condition, and mass (at the 3 points measured after hatching)?
#### Juv1_SVL: effect of temperature- cooler temps larger svl
#### Juv2_SVL: no effects - hormonal effect p = 0.07
#### Juv3_SVL: high hormone low body size; males smaller than females
#### Juv1_MASS: low mass with high hormones; low mass with high temperatures
#### Juv2_MASS: low mass with high temperatures
#### Juv3_MASS: low mass males
#### Juv1_BCI: no treatment effects
#### Juv2_BCI: no treatment effects
#### Juv3_BCI: Sex effect: male lower BCI than females - could be size difference
#### SURVIVAL: no differences between treatments
#### GROWTH SVL (Hatchling-Juvenile): No treatment effects
#### GROWTH MASS (Hatchling-Juvenile): No treatment effects

# final raw data that have morphometrics (svl, mass, and BCI residuals) across life stage 
data_final <- read.csv(here("Kwild_code/data/final_analysis_data.csv"))

##################
#### SVL ANALYSIS: Juv_1, Juv_2, Juv_3 (sex accounted for last measurement)
### JUV_1: SVL; interaction removed
SVL_Juv1_mod <- readRDS(here("Kwild_code/models/SVL_Juv1_mod.RDS"))
# effect on temperature and day of hatch on body size 
SVL_Juv1_mod_summ <- summary(SVL_Juv1_mod) 
SVL_Juv1_mod_summ <- as.data.frame(round(SVL_Juv1_mod_summ$coefficients, 
                                          digits = 2))
# cooler temps larger svl
SVL_Juv1_mod_emm <- emmeans(SVL_Juv1_mod, pairwise ~ temp)
SVL_Juv1_mod_emm_value <- SVL_Juv1_mod_emm$emmeans
SVL_Juv1_mod_emm_con <- SVL_Juv1_mod_emm$contrasts

### JUV_2: SVL; interaction removed
SVL_Juv2_mod <- readRDS(here("Kwild_code/models/SVL_Juv2_mod.RDS"))
# marginal hermonal effect on body size p = 0.06
SVL_Juv2_mod_summ <- summary(SVL_Juv2_mod) 
SVL_Juv2_mod_summ <- as.data.frame(round(SVL_Juv2_mod_summ$coefficients, 
                                          digits = 2))

### JUV_3: SVL - NOTE SEX ACCOUTNED for; no interaction
SVL_Juv3_mod <- readRDS(here("Kwild_code/models/SVL_Juv3_mod.RDS"))
# effect on hormones and sex
SVL_Juv3_mod_summ <- summary(SVL_Juv3_mod)
SVL_Juv3_mod_summ <- as.data.frame(round(SVL_Juv3_mod_summ$coefficients, 
                                          digits = 2))
#  high hormone lower svl
SVL_Juv3_hormone_mod_emm <- emmeans(SVL_Juv3_mod, pairwise ~ hormone)
SVL_Juv3_hormone_mod_emm_value <- SVL_Juv3_hormone_mod_emm$emmeans
SVL_Juv3_hormone_mod_emm_cont <- SVL_Juv3_hormone_mod_emm$contrasts
# plot - males are smaller than females
SVL_Juv3_sex_mod_emm <- emmeans(SVL_Juv3_mod, pairwise ~ sex)
SVL_Juv3_sex_mod_emm_value <- SVL_Juv3_sex_mod_emm$emmeans
SVL_Juv3_sex_mod_emm_cont <- SVL_Juv3_sex_mod_emm$contrasts


######################
#### MASS ANALYSIS: Juv_1, Juv_2, Juv_3 (sex accounted for last measurement)
### Juv_1: MASS - interaction removed
Mass_Juv1_mod <- readRDS(here("Kwild_code/models/Mass_Juv1_mod.RDS"))
# effect on temp, and days since hatch
Mass_Juv1_mod_summ <- summary(Mass_Juv1_mod)
Mass_Juv1_mod_summ <- as.data.frame(round(Mass_Juv1_mod_summ$coefficients, 
                                          digits = 2))
# temp plot - low mass with high temperatures
Mass_Juv1_temp_mod_emm <- emmeans(Mass_Juv1_mod, pairwise ~ temp)
Mass_Juv1_temp_mod_emm_value <- Mass_Juv1_temp_mod_emm$emmeans
Mass_Juv1_temp_mod_emm_cont <- Mass_Juv1_temp_mod_emm$contrasts

#### MASS: Juv_2; interaction removed
Mass_Juv2_mod <- readRDS(here("Kwild_code/models/Mass_Juv2_mod.RDS"))
# temp  effect
Mass_Juv2_mod_summ <- summary(Mass_Juv2_mod)
Mass_Juv2_mod_summ <- as.data.frame(round(Mass_Juv2_mod_summ$coefficients, 
                                          digits = 2))
# temp plot - low mass with high temperatures
Mass_Juv2_temp_mod_emm <- emmeans(Mass_Juv2_mod, pairwise ~ temp)
Mass_Juv2_temp_mod_emm_value <-Mass_Juv2_temp_mod_emm$emmeans
Mass_Juv2_temp_mod_emm_con <-Mass_Juv2_temp_mod_emm$contrasts

#### MASS: Juv_3; NOTE SEX IS ACCOUNTED FOR
Mass_Juv3_mod <- readRDS(here("Kwild_code/models/Mass_Juv3_mod.RDS"))
# sex effect
Mass_Juv3_mod_summ <- summary(Mass_Juv3_mod)
Mass_Juv3_mod_summ <- as.data.frame(round(Mass_Juv3_mod_summ$coefficients, 
                                          digits = 2))
# temp plot - males smaller than females
Mass_Juv3_sex_mod_emm <- emmeans(Mass_Juv3_mod, pairwise ~ sex)
Mass_Juv3_sex_mod_emm_value <- Mass_Juv3_sex_mod_emm$emmeans
Mass_Juv3_sex_mod_emm_cont <- Mass_Juv3_sex_mod_emm$contrasts


###############
#### BCI ANALYSIS: Juv_1, Juv_2, Juv_3 (sex accounted for last measurement)
### BCI: Juv1 - BCI residuals; interaction removed
condition_juv1_mod <- readRDS(here("Kwild_code/models/condition_juv_mod.RDS"))
# no treatment effects 
condition_juv1_mod_summ <- summary(condition_juv1_mod)
condition_juv1_mod_summ <- as.data.frame(round(condition_juv1_mod_summ$coefficients, 
                                          digits = 2))

### BCI: Juv2 - BCI residuals; interaction removed
condition_juv2_mod <- readRDS(here("Kwild_code/models/condition_juv2_mod.RDS"))
# no treatment effects 
condition_juv2_mod_summ <- summary(condition_juv2_mod)
condition_juv2_mod_summ <- as.data.frame(round(condition_juv2_mod_summ$coefficients, 
                                          digits = 2))

### BCI: Juv3 - BCI residuals; interaction removed
condition_juv3_mod <- readRDS(here("Kwild_code/models/condition_juv3_mod.RDS"))
# sex differences 
condition_juv3_mod_summ <- summary(condition_juv3_mod)
condition_juv3_mod_summ <- as.data.frame(round(condition_juv3_mod$coefficients, 
                                          digits = 2))
# sex differences
condition_juv3_sex_mod_emm <- emmeans(condition_juv3_mod, pairwise ~ sex)
condition_juv3_sex_mod_emm_value <- condition_juv3_sex_mod_emm$emmeans
condition_juv3_sex_mod_emm_cont <- condition_juv3_sex_mod_emm$contrasts


###############
#### Survival analysis to JUV 3 : hormone and temp 
##fisher test- filter out missing animals
survival<- data_final %>% 
  filter(liz_status_db != "MISSING")
survival_tbl <- table(survival$liz_status_db)
# analysis between temperature and treatment 
survival_hormone <- kruskal.test(liz_status_db ~ hormone, data = survival)
survival_temp <- kruskal.test(liz_status_db ~ temp, data = survival)
# summaries: hormone & temp 
survival_results <- data.frame(
  Treatment = c("Hormone", "Temperature"),
  Test = c(survival_temp$method, survival_temp$method),
  Statistic = c(survival_hormone$statistic, survival_temp$statistic),
  P_value = c(survival_hormone$p.value, survival_temp$p.value))


###############
#### SVL growth rate: hatchling to Juv_3 
# SVL; interaction removed
overall_SVL_growth_mod <-  readRDS(here("Kwild_code/models/overall_SVL_growth_mod.RDS"))
# no treatment effects
overall_SVL_growth_mod_summ <- summary(overall_SVL_growth_mod)
overall_SVL_growth_mod_summ <- as.data.frame(round(overall_SVL_growth_mod_summ$coefficients, 
                                          digits = 2))

#### MASS growth rate: hatchling to Juv_3  
# Mass test; interaction removed
overall_mass_growth_mod <- readRDS(here("Kwild_code/models/growth4_mass_mod.RDS"))
# treatment effect on temp but not hormone
overall_mass_growth_mod_summ <- summary(overall_mass_growth_mod)
overall_mass_growth_mod_summ <- as.data.frame(round(overall_mass_growth_mod_summ$coefficients, 
                                          digits = 2))
```

\newpage
## Figures and Tables:
```{r}
#| echo: FALSE
#| warning: FALSE
#| fig-width: 9
#| fig-height: 7
#| fig-align: left
# final raw data that have morphometrics (svl, mass, and BCI residuals) across life stage 
data_final <- read.csv(here("Kwild_code/data/final_analysis_data.csv")) %>% 
  mutate(data_final, hormone = factor(hormone, 
                                      levels = c("control","low","high"))) %>% 
  filter(!is.na(hormone)) %>%
  group_by(hormone)

# plot set up
hormones <- c("#999999", "#E69F00", "brown2")
my_comparisons <- rev(list(c("control","low"),c("control","high-"),c("low","high")))

########### FIGURE 2: temperature and morphology effects of developmental 
# treatments on body size, condition, and mass at hatching;
fig1_A <- ggviolin(data_final, x = "hormone", y = "hatch_svl_mm",
                    color = "hormone", palette = hormones,
                    short.panel.labs = FALSE,
                    font.label = list(size = 12, color = "black"),
                    ggtheme = theme_bw())+ 
  geom_jitter(aes(color = hormone), width = 0.2, alpha = 0.6) +  # Adding raw data points with color and transparency
  
  # Adding mean and standard error
  stat_summary(
    mapping = aes(x = hormone, y = hatch_svl_mm),
    fun = "mean", geom = "point", size = 3, color = "black", alpha = 0.6) +
  stat_summary(
    mapping = aes(x = hormone, y = hatch_svl_mm),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black", alpha = 0.6) +
  
  stat_compare_means(comparisons = list(c("control","low"), c("control","high"), c("low","high"))) +
  stat_compare_means(method = "anova")+
  labs(x = NULL, y = "Hatchling SVL (mm)") +
  labs(color='Hormone Treatment')+
  scale_y_continuous(breaks=seq(14, 22, 2), limits = c(14, 22))+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = "none")
# B) hatchling mass * hormone
Fig1_B <- ggviolin(data_final, x = "hormone", y = "hatch_mass_g",
                    color = "hormone", palette = hormones,
                    short.panel.labs = FALSE,
                    font.label = list(size = 12, color = "black"),
                    ggtheme = theme_bw()) +
  geom_jitter(aes(color = hormone), width = 0.2, alpha = 0.4) +  # Adding raw data points with color and transparency
  
  # Adding mean and standard error
  stat_summary(
    mapping = aes(x = hormone, y = hatch_mass_g),
    fun = "mean", geom = "point", size = 3, color = "black", alpha = .6) +
  stat_summary(
    mapping = aes(x = hormone, y = hatch_mass_g),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black", alpha = 0.6) +
  stat_compare_means(comparisons = list(c("control","low"), c("control","high"), c("low","high"))) +
  stat_compare_means(method = "anova") +
  labs(x = NULL, y = "Hatchling mass (g)") +
  labs(color='Hormone Treatment')+
  scale_y_continuous(breaks=seq(0.06, 0.20, .02), limits = c(0.06,0.20))+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = c(0.99, 0.99),  # Positions the legend inside the plot
        legend.justification = c("right", "top"), # Justifies the legend's position
        legend.background = element_blank(),
        legend.key = element_blank(),
        legend.box = element_blank(),
        legend.text = element_text(size = 7),
        legend.title = element_text(size =8))

fig1 <- plot_grid(fig1_A, Fig1_B, ncol = 2, align = "h", labels = c("A", "B"))
fig1
```
**Figure 1A|B:** Hatchling morphology body size (SVL) and mass are effected by hormonal treatment during development. Panel A shows hatchling SVL (mm) and panel B shows hatchling mass (g). Colors indicate hormonal treatment during development: control (grey), low (gold), and high (red). Bars above plots indicate pairwise comparisons of morphometric measurements across hormonal treatment. Means and SE intervals are provided along with the p-value for each contrast.

\newpage
```{r}
#| echo: FALSE
#| warning: FALSE
#| fig-width: 9
#| fig-height: 7
#| fig-align: left
data_final <- read.csv(here("Kwild_code/data/final_analysis_data.csv"))%>% 
  mutate(data_final, hormone = factor(hormone, 
                                      levels = c("control","low","high"))) %>% 
  filter(!is.na(hormone)) %>%
  group_by(hormone)

# plot set up
temps <- c("Blue", "Red")
hormones <- c("#999999", "#E69F00", "brown2")
my_comparisons <- rev(list(c("control","low"),c("control","high-"),c("low","high")))


fig2_A <- ggviolin(data_final, x = "temp", y = "hatch_mass_g",
                    color = "temp", palette = temps,
                    short.panel.labs = FALSE,
                    font.label = list(size = 14, color = "black"),
                    ggtheme = theme_bw()) +
  
  geom_jitter(aes(color = temp), width = 0.2, alpha = 0.4) + 
  stat_summary(
    mapping = aes(x = temp, y = hatch_mass_g),
    fun = "mean", geom = "point", size = 2, color = "black", alpha = .5) +
  stat_summary(
    mapping = aes(x = temp, y = hatch_mass_g),
    fun.data = "mean_se", geom = "errorbar", width = .1, color = "black", alpha = .5) +
  stat_compare_means(method = "anova") +
  labs(x = "Temperature (°C)", y = "Hatchling mass (g)") +
  labs(color='Temperature Treatment')+
  scale_y_continuous(breaks=seq(0.06, 0.18, .02), limits = c(0.06,0.18)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = "none")

# body condition and temp
fig2_B <- ggviolin(data_final, x = "temp", y = "hatch_bc_residuals",
                   color = "temp", palette = temps,
                   short.panel.labs = FALSE,
                   font.label = list(size = 14, color = "black"),
                   ggtheme = theme_bw()) + 
  geom_jitter(aes(color = temp), width = 0.2, alpha = 0.4) +  
  stat_summary(
    mapping = aes(x = temp, y = hatch_bc_residuals),
    fun = "mean", geom = "point", size = 2, color = "black", alpha = .5 ) +
  stat_summary(
    mapping = aes(x = temp, y = hatch_bc_residuals),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black", alpha = .5) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black") +
  stat_compare_means(method = "anova", vjust = -.1, hjust = .5)+ 
  labs(x = "Temperature (°C)", y = "BCI") +
  labs(color='Incubation Treatment')+
  scale_y_continuous(breaks=seq(-0.06, 0.06, 0.02), limits = c(-0.06, 0.06))+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = c(0.99, 0.99),  # Positions the legend inside the plot
        legend.justification = c("right", "top"), # Justifies the legend's position
        legend.background = element_blank(),
        legend.key = element_blank(),
        legend.box = element_blank(),
        legend.text = element_text(size = 6),
        legend.title = element_text(size = 8))

fig2 <- plot_grid(fig2_A, fig2_B, ncol = 2, align = "h", labels = c("A", "B"))
fig2
```
**Figure 2 A|B:** How developmental temperature effects mass (panel A) and body condition (panel B) of hatchling lizards. Colors indicate the incubation temperature that eggs were reared in. Means and SE intervals are provided along with the p-value. Dashed horizontal line in Panel B indicates average condition, points that fall above the line are considered "good" condition and points below line are considered "poor".
\newpage

## Supplementary information

<p>
```{r, figS1}
#| echo: FALSE
#| warning: FALSE
#| fig-width: 5
#| fig-height: 5
#| fig-align: center
# final raw data that have morphometrics (svl, mass, and BCI residuals) across life stage 
data_final <- read.csv(here("Kwild_code/data/final_analysis_data.csv"))

#plot set up
temps <- c("Blue", "Red")
my_comparisons <- rev(list(c("control","low"),c("control","high-"),c("low","high")))

########## FIGURE 1: temperature and morphology: effects of developmental treatments (temp, cort, interaction) on time to hatch: -	Effect on temperature: warmer temps faster development
figS1 <- ggviolin(data_final, x = "temp", y = "days_to_hatch",
                 color = "temp", palette = temps,
                 short.panel.labs = FALSE,
                 font.label = list(size = 14, color = "black"),
                 ggtheme = theme_bw()) + 
  geom_jitter(aes(color = temp), width = 0.2, alpha = 0.4) +  # Adding raw data points
  
  # Adding mean and standard error
  stat_summary(
    mapping = aes(x = temp, y = days_to_hatch),
    fun = "mean", geom = "point", size = 2, color = "black", alpha = 0.6) +
  stat_summary(
    mapping = aes(x = temp, y = days_to_hatch),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black",  alpha = 0.6) +
  
  stat_compare_means(method = "anova", vjust = -.1, hjust = 0)+ 
  labs(x = "Temperature (°C)", y = "Incubation time (days)") +
  labs(color='Incubation Temperature')+
  scale_y_continuous(breaks=seq(25, 60, 5), limits = c(25,60)) +
  theme(legend.position = c(.95, .95), # Position the legend inside the plot at the top right corner
        legend.justification = c("right", "top"), # Justify the legend to the top right
        panel.grid.major = element_blank(),  # Remove major grid lines
        panel.grid.minor = element_blank()) + # Remove minor grid lines
  guides(color = guide_legend(nrow = 2))  # Ensure that legend items are in a single column
figS1
```
**Figure S1:** Incubation temperature effects on developmental time to hatch. Means and SE are provided along with the p-value.
<p>


## Figures to be used....
<p>
```{r}
#| echo: FALSE
#| warning: FALSE
#| fig-width: 10
#| fig-height: 7
#| fig-align: center
data_final <- read.csv(here("Kwild_code/data/final_analysis_data.csv"))%>% 
  mutate(data_final, hormone = factor(hormone, 
                                      levels = c("control","low","high"))) %>% 
  filter(!is.na(hormone)) %>%
  group_by(hormone)
# filtering cort data
cort_dat <- data_final %>%
  drop_na(juv3_CORT_Final_Hormone_ng_mL, temp, hormone, juv3_HandlingTime_sec)

# plot set up
hormones <- c("#999999", "#E69F00", "brown2")
my_comparisons <- rev(list(c("control","low"),c("control","high-"),c("low","high")))
# figure
Fig4 <- ggviolin(data_final, x = "hormone", y = "juv3_CORT_Final_Hormone_ng_mL",
                   color = "hormone", palette = hormones,
                   short.panel.labs = FALSE,
                   font.label = list(size = 14, color = "black"),
                   ggtheme = theme_bw()) +
  geom_jitter(aes(color = hormone), width = 0.2, alpha = 0.4) +
  stat_compare_means(comparisons = list(c("control","low"), c("control","high"), c("low","high"))) +
  stat_compare_means(method = "anova") +#
  stat_summary(
    mapping = aes(x = hormone, y = juv3_CORT_Final_Hormone_ng_mL),
    fun = "mean", geom = "point", size = 3, color = "black", alpha = .6) +
  stat_summary(
    mapping = aes(x = hormone, y = juv3_CORT_Final_Hormone_ng_mL),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black", alpha = 0.6) +
  labs(x = "Hormonal Treatment During Development", y = "Cort Final Hormone (ng/mL)") +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = c(0.99, 0.99),  # Positions the legend inside the plot
        legend.justification = c("right", "top"), # Justifies the legend's position
        legend.background = element_blank())
Fig4
```

**Figure XX**. Final CORT measurements (ng/mL) of juvinile lizards based off hormonal treatment during development. Colors indicate hormonal treatment during development: control (grey), low (gold), and high (red). Bars above plots indicate pairwise comparisons of final CORT measurements across hormonal treatment. Means and SE intervals are provided along with the p-value for each contrast.

```{r}
#| echo: FALSE
#| warning: FALSE
#| fig-width: 10
#| fig-height: 7
#| fig-align: center
data_final <- read.csv(here("Kwild_code/data/final_analysis_data.csv"))
cort_dat <- data_final %>%
  drop_na(juv3_CORT_Final_Hormone_ng_mL, temp, hormone, juv3_HandlingTime_sec)

# function for plot to show pvalue and correlation coefficient 
calc_cor <- function(data, x, y) {
  cor_test <- cor.test(data[[x]], data[[y]])
  cor <- cor_test$estimate
  p_value <- cor_test$p.value
  return(data.frame(cor = cor, p_value = p_value))
}

# Calculate correlation and p-values for each plot
cor_res_A <- calc_cor(cort_dat, "hatch_juv3_SVL_growth", "juv3_CORT_Final_Hormone_ng_mL")
cor_res_B <- calc_cor(cort_dat, "hatch_juv3_MASS_growth", "juv3_CORT_Final_Hormone_ng_mL")

# Adding p-values and correlation coefficients on the plots
fig5_A <- ggplot(cort_dat, aes(x = hatch_juv3_SVL_growth, y = juv3_CORT_Final_Hormone_ng_mL)) +
  geom_point(aes(color = as.factor(temp), shape = hormone), size = 2) + 
  geom_smooth(method = "lm", se = FALSE, color = "black", linetype = 2) +
  labs(x = "SVL growth rate (mm/d)", y = "CORT Final Hormone (ng/mL)", 
       color = "Temperature", shape = "Treatment") +
  scale_color_discrete(name = "Temperature") + 
  geom_text(aes(x = Inf, y = Inf, 
                label = sprintf("r = %.2f, p = %.3f", cor_res_A$cor, cor_res_A$p_value)), 
            hjust = 0, vjust = 1) + # Adjust hjust and vjust to position the text
  theme_bw() +
  theme(legend.position = "none", 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))


# Repeat similar process for fig4_B
fig5_B <- ggplot(cort_dat, aes(x = hatch_juv3_MASS_growth, y = juv3_CORT_Final_Hormone_ng_mL)) +
  geom_point(aes(color = as.factor(temp), shape = hormone), size = 2) + 
  geom_smooth(method = "lm", se = FALSE, color = "black", linetype = 2) +
  labs(x = "Mass growth rate (g/d)", y = NULL, 
       color = "Temperature", shape = "Treatment") +
  scale_color_discrete(name = "Temperature") + 
  geom_text(aes(x = Inf, y = Inf, 
                label = sprintf("r = %.2f, p = %.3f", cor_res_B$cor, cor_res_B$p_value)), 
            hjust = 0, vjust = 1) + # Adjust hjust and vjust to position the text
  theme_bw() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = c(0.99, 0.99),  # Positions the legend inside the plot
        legend.justification = c("right", "top"), # Justifies the legend's position
        legend.background = element_blank(),
        legend.key = element_blank(),
        legend.box = element_blank(),
        legend.text = element_text(size = 6),
        legend.title = element_text(size = 8))

fig5 <- plot_grid(fig5_A, fig5_B, ncol = 2, align = "h", labels = c("A", "B"))
fig5
```

**Figure XX**. The relationship final cort measurements and juvenile growth rate. Growth period was determined from hatchling to final measurement (mean = 467 days). Panel A shows SVL change (mm/d) and panel B shows mass change (g/d). Colors show the incubation temperature during development and symbols show the hormonal treatment during development. Overall there were no relationships between incubation temperature during development or hormonal treatment during development and final CORT values. However there was an overall positive relationship between final CORT measurements and growth rate.

```{r}
#| echo: FALSE
#| warning: FALSE
#| fig-width: 10
#| fig-height: 7
#| fig-align: right
# Bring in T4 data and the model
t4_dat <- read.csv(here("Kwild_code/data/final_analysis_data.csv")) %>% 
   drop_na(juv3_T4_corrected_ng_mL, temp, hormone, Lizard_ID)

T4_mass_growth_mod <-readRDS(here("Kwild_code/models/T4_mass_growth_mod.RDS"))
# PLOT: predicitions: growth and T4 and cort
newdata <- data.frame(`juv3_CORT_Final_Hormone_ng_mL` = seq(from = min(t4_dat$juv3_CORT_Final_Hormone_ng_mL), 
                                                            to = max(t4_dat$juv3_CORT_Final_Hormone_ng_mL),
                                                            length.out = 100),
                      `juv3_T4_corrected_ng_mL` = rep(seq(from = min(t4_dat$juv3_T4_corrected_ng_mL), 
                                                          to = max(t4_dat$juv3_T4_corrected_ng_mL)), 
                                                      each = 100), temp = 23)

newdata$pred <- predict(T4_mass_growth_mod, newdata = newdata)

# another plot
s <- interp(x = newdata$juv3_T4_corrected_ng_mL, 
            y = newdata$juv3_CORT_Final_Hormone_ng_mL, 
            z = newdata$pred)
image.plot(s, xlab = "T4_ng_mL", ylab = "Cort_ng_mL", 
           las = 1, col = viridis(option = "magma", 50), 
           cex.axis = 1, axis.args = list(cex.axis = 1.5), cex.lab = 1.8,
           xlim = c(min(newdata$juv3_T4_corrected_ng_mL)+.012, 
                    max(newdata$juv3_T4_corrected_ng_mL)-.011),  # Explicitly defining x limits
           ylim = c(min(newdata$juv3_CORT_Final_Hormone_ng_mL)+8, 
                    max(newdata$juv3_CORT_Final_Hormone_ng_mL)))  # Explicitly defining y limits
contour(s, add = TRUE, col = "white")
```

**Figure XX**. Predicted parametric contour plots of mass growth rate as a function of our standardized traits from generalized linear models. Colors indicate the r mass growth rate of individual lizards: dark purple = relative growth rate -1.0 (g) and below, purple = relative growth rate -0.5 and 0.5 (g), red = relative growth rate 0.5 and 1.5 (g), and yellow = relative growth rate greater than 1.5 (g).

```{r}
#| echo: FALSE
#| warning: FALSE
#| fig-width: 10
#| fig-height: 7
#| fig-align: right
# Bring in T4 data and the model
t4_dat <- read.csv(here("Kwild_code/data/final_analysis_data.csv")) %>% 
   drop_na(juv3_T4_corrected_ng_mL, temp, hormone, Lizard_ID)

fig7 <- ggviolin(t4_dat, x = "sex", y = "juv3_T4_corrected_ng_mL",
                   color = "sex", short.panel.labs = FALSE,
                   font.label = list(size = 12, color = "black"),
                   ggtheme = theme_bw()) + 
  geom_jitter(aes(color = sex), width = 0.2, alpha = 0.4) +  
  stat_summary(
    mapping = aes(x = sex, y = juv3_T4_corrected_ng_mL),
    fun = "mean", geom = "point", size = 2, color = "black", alpha = .5 ) +
  stat_summary(
    mapping = aes(x = sex, y = juv3_T4_corrected_ng_mL),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black", alpha = .5) +
  stat_compare_means(method = "anova", vjust = -.1, hjust = .5)+ 
  labs(x = "Sex", y = "T4 (ng/mL)") +
  labs(color='Sex')+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = c(0.99, 0.99),  # Positions the legend inside the plot
        legend.justification = c("right", "top"), # Justifies the legend's position
        legend.background = element_blank(),
        legend.key = element_blank(),
        legend.box = element_blank(),
        legend.text = element_text(size = 6),
        legend.title = element_text(size = 8))

fig7
```

**Figure XX**. Differences in T4 levels between male (red) and female (blue) lizards. Means and SE intervals are provided along with the p-value.
