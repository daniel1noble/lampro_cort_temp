---
title: "Results"
format:
  docx:
    reference-doc: ../../bib/template.docx
editor_options: 
  chunk_output_type: console
execute:
  freeze: auto  # re-render only when source changes
  cache: false
  echo: false
  warning: false
  error: false
  include: true
crossref:
  fig-title: 'Figure'
  fig-labels: arabic
  title-delim: "-"
  fig-prefix: "Figure"
  tbl-prefix: "Table"
---

```{r setup, include=FALSE, eval = T, echo = FALSE}
## Packages and set up
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(message = FALSE)
options(digits = 3)
rm(list=ls())
sessionInfo()
pacman::p_load(dplyr, flextable, knitr, tibble, car, here, dplyr, tidyverse, ggpubr, lme4, emmeans, car, lmerTest, lubridate, performance, cowplot, interp, ggpubr, ggplot2, stats, rotl, dplyr, viridis, patchwork, interp, akima, MASS, magick, fields)

# Function for p-value rendering nicely
#' @title p_value
#' @description Checks p-value and assigned to catagories unless non-significant then gives actual p
#' @param x the value to check against
#' 
p_value <- function(x){
  if(x <= 0.0001) {tmp = "< 0.0001"}
  if(x <= 0.001 & x >= 0.0001) {tmp ="< 0.001"}
  if(x <= 0.01 & x >= 0.001) {tmp ="< 0.01"}
  if(x >= 0.01) {tmp = round(x, digits =2)}
  return(tmp)
}

```

```{r}
#| echo: false
##### data used in analysis
final_analysis_data <- read.csv(here("Kwild_code/data/final_analysis_data_quarto.csv"))
# sample size
n_all <- final_analysis_data %>% 
  summarise(sample_size = n_distinct(Lizard_ID))
n_temp_horm_trt <- final_analysis_data %>%
  group_by(as.character(temp), hormone) %>% 
  summarise(n = n())
n_temp_trt <- final_analysis_data %>%
  group_by(as.character(temp)) %>% 
  summarise(n = n())  
n_horm_trt <- final_analysis_data %>%
  group_by(hormone) %>% 
  summarise(n = n())  


```

A total of `r n_all[1,1]` eggs were randomly allocated into two incubation treatments (cold 23ºC n = `r n_temp_trt[1,2]`; hot 28ºC n = `r n_temp_trt[2,2]`). Within each temperature treatment, eggs were then randomly allocated into their hormone treatment (control n = `r n_horm_trt[1,2]`; low n = `r n_horm_trt[3,2]`; high n = `r n_horm_trt[2,2]`).

### *a) Early developmental temperature and CORT impact hatchling phenotype*

```{r}
#| echo: false

################
#### 1.	What are the effects of developmental treatments (temp, cort, interaction) on time to hatch?
#### effect of temperature on incubation days - faster hatch warmer temps 
################
# mod ; interaction removed
hatch_dev_mod <- readRDS(here("Kwild_code/models/hatch_dev_mod.RDS"))
hatch_dev_mod_summ <- summary(hatch_dev_mod)
hatch_dev_mod_summ <- as.data.frame(round(hatch_dev_mod_summ$coefficients, 
                                          digits = 2))
hatch_dev_mod_anova <- as.data.frame(Anova(hatch_dev_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2)) 

# faster hatch warmer temps
hatch_dev_mod_emm <- emmeans(hatch_dev_mod, pairwise ~ temp)
hatch_dev_mod_emm_value <- as.data.frame(hatch_dev_mod_emm$emmeans) %>% 
  mutate(emmean = round(emmean, digits = 1),
         SE = round(SE, digits = 2),
         LCL = round(lower.CL, digits = 2),
         UCL = round(upper.CL, digits = 2))
hatch_dev_mod_emm_cont <- data.frame(hatch_dev_mod_emm$contrasts)


################
#### 2.	What are the effects of developmental treatments on body size, mass, and condition (BCI) of HATCHLINGS
#### SVL: hormone effects body size; no interaction effects
#### MASS: temperature and hormone effects mass; no interaction effects
#### BCI:  temperature has effect on BCI; no effect on hormone; no interaction effects
################
#### SVL; interaction removed
# hormone effects body size; no effects on temp or no interaction effects
SVL_hatch_mod <- readRDS(here("Kwild_code/models/SVL_hatch_mod.RDS"))
SVL_hatch_mod_summ <- summary(SVL_hatch_mod)
SVL_hatch_mod_summ <- as.data.frame(round(SVL_hatch_mod_summ$coefficients, 
                                          digits = 2))
SVL_hatch_mod_anova <- as.data.frame(Anova(SVL_hatch_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2)) 
# high hormone lower SVL
SVL_hatch_mod_emm <- emmeans(SVL_hatch_mod, pairwise ~ hormone)
SVL_hatch_mod_emm_value <- SVL_hatch_mod_emm$emmeans
SVL_hatch_mod_emm_cont <- data.frame(SVL_hatch_mod_emm$contrasts)

################
#### MASS; interaction removed
Mass_hatch_mod <- readRDS(here("Kwild_code/models/MASS_hatch_mod.RDS"))
# temperature and hormone effects mass; no interaction effects
Mass_hatch_mod_summ <- summary(Mass_hatch_mod)
Mass_hatch_mod_summ <- as.data.frame(round(Mass_hatch_mod_summ$coefficients, 
                                          digits = 2))
Mass_hatch_mod_anova <- as.data.frame(Anova(Mass_hatch_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2)) 
# hormone pairwise comparison - control higher mass
Mass_hormone_hatch_mod_emm <- emmeans(Mass_hatch_mod, pairwise ~ hormone)
Mass_hormone_hatch_mod_emm_value <- Mass_hormone_hatch_mod_emm$emmeans
Mass_hormone_hatch_mod_emm_cont <- data.frame(Mass_hormone_hatch_mod_emm$contrasts)
# temp pairwise comparison - cooler temps higher mass
Mass_temp_hatch_mod_emm <- emmeans(Mass_hatch_mod, pairwise ~ temp)
Mass_temp_hatch_mod_emm_value <- Mass_temp_hatch_mod_emm$emmeans
Mass_temp_hatch_mod_emm_cont <- data.frame(Mass_temp_hatch_mod_emm$contrasts)

################
#### BCI from residuals (OLS); interaction removed
# hatchlings- residuals from SVL and mass
## hatchlings-anova on BCI residuals; interaction removed
condition_hatch_mod <- readRDS(here("Kwild_code/models/condition_hatch_mod.RDS"))
# temperature has effect on BCI; no effect on hormone, or temp x hormone interaction
condition_hatch_mod_summ <- summary(condition_hatch_mod)
condition_hatch_mod_summ <- as.data.frame(round(condition_hatch_mod_summ$coefficients, 
                                          digits = 2))
condition_hatch_mod_anova <- as.data.frame(Anova(condition_hatch_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2)) 
# temp and BCI plot - poor BCI warm temps
condition_hatch_mod_emm <- emmeans(condition_hatch_mod, pairwise ~ temp)
condition_hatch_mod_emm_value <- condition_hatch_mod_emm$emmeans
condition_hatch_mod_emm_value <- condition_hatch_mod_emm$contrasts
```

CORT treatment did not affect time to hatch ($F_{`r hatch_dev_mod_anova$Df[2]`,`r hatch_dev_mod_anova$Df[4]`}$ = `r hatch_dev_mod_anova[2,3]`, p = `r p_value(hatch_dev_mod_anova[2,4])`), but as expected, developmental temperature significantly decreased development time ($F_{`r hatch_dev_mod_anova$Df[1]`,`r hatch_dev_mod_anova$Df[4]`}$ = `r hatch_dev_mod_anova[1,4]`, p = `r p_value(hatch_dev_mod_anova[1,4])`; Figure S1). On average, the incubation duration of the cold treatment was `r hatch_dev_mod_emm_cont[,"estimate"]` days longer than the hot treatment (±SE: `r hatch_dev_mod_emm_cont[,"SE"]`, *t*-value = `r hatch_dev_mod_emm_cont[,"t.ratio"]`, df = `r hatch_dev_mod_emm_cont[,"df"]`, p = `r p_value(hatch_dev_mod_emm_cont[,"p.value"])`) with the incubation duration for the hot treatment being `r hatch_dev_mod_emm_value[1,2]` days (`r hatch_dev_mod_emm_value[1,3]` ±SE) and the cold treatment `r hatch_dev_mod_emm_value[2,2]` days (`r hatch_dev_mod_emm_value[2,3]`±SE).

CORT significantly decreased hatchling mass ($F_{`r Mass_hatch_mod_anova$Df[3]`,`r Mass_hatch_mod_anova$Df[4]`}$ = `r Mass_hatch_mod_anova[2,4]`, p = `r p_value(Mass_hatch_mod_anova[2,4])`), but only between control and the highest dose (marginalised mean: `r Mass_hormone_hatch_mod_emm_cont[1,"estimate"]` ±SE `r Mass_hormone_hatch_mod_emm_cont[1,"SE"]`, t = `r Mass_hormone_hatch_mod_emm_cont[1,"t.ratio"]`, df = `r Mass_hormone_hatch_mod_emm_cont[1,"df"]`, p = `r p_value(Mass_hormone_hatch_mod_emm_cont[1,"p.value"])`). Hatching SVL was similarly affected by CORT ($F_{`r SVL_hatch_mod_anova$Df[3]`,`r SVL_hatch_mod_anova$Df[4]`}$ = `r SVL_hatch_mod_anova[2,3]`, p = `r p_value(SVL_hatch_mod_anova[3,4])`) compared to control treatments, but again, only at high CORT levels (marginalised mean: `r SVL_hatch_mod_emm_cont[1,"estimate"]` ±SE `r SVL_hatch_mod_emm_cont[1,"SE"]`, t = `r SVL_hatch_mod_emm_cont[1,"t.ratio"]`, df = `r SVL_hatch_mod_emm_cont[1,"df"]`, p = `r p_value(SVL_hatch_mod_emm_cont[1,"p.value"])` @fig-Figure_1).

High temperatures also contributed to marginal decrease in hatchling mass ($F_{`r Mass_hatch_mod_anova$Df[2]`,`r Mass_hatch_mod_anova$Df[3]`}$ = `r Mass_hatch_mod_anova[2,3]`, p = `r p_value(Mass_hatch_mod_anova[2,4])`; @fig-Figure_2) and resulted in poorer body condition ($F_{`r condition_hatch_mod_anova$Df[1]`,`r condition_hatch_mod_anova$Df[4]`}$ = `r condition_hatch_mod_anova[2,3]`, p = `r p_value(condition_hatch_mod_anova[1,4])`; @fig-Figure_2 B). Temperature treatment did not have an overall effect on hatchling SVL ($F_{`r SVL_hatch_mod_anova$Df[1]`,`r SVL_hatch_mod_anova$Df[4]`}$ = `r SVL_hatch_mod_anova[2,3]`, p = `r p_value(SVL_hatch_mod_anova[2,4])`) and hormonal treatment did not affect hatchling body condition ($F_{`r condition_hatch_mod_anova$Df[3]`,`r condition_hatch_mod_anova$Df[4]`}$ = `r condition_hatch_mod_anova[3,3]`, p = `r p_value(condition_hatch_mod_anova[3,4])`).

```{r, Figure_1}
#| label: fig-Figure_1
#| fig-cap: "Hatchling morphology body size (SVL) and mass are effected by hormonal treatment during development. Panel A shows hatchling SVL (mm) and panel B shows hatchling mass (g). Colors indicate hormonal treatment during development: control (grey), low (gold), and high (red). Bars above plots indicate pairwise comparisons of morphometric measurements across hormonal treatment. Means and SE intervals are provided along with the p-value for each contrast."
#| warning: FALSE
#| echo: FALSE
#| fig-width: 9
#| fig-height: 7
#| fig-align: left

# final raw data that have morphometrics (svl, mass, and BCI residuals) across life stage 
  data_final <- read.csv(here("Kwild_code/data/final_analysis_data.csv")) 
  
  data_final <- data_final%>% 
  mutate(data_final, hormone = factor(hormone, 
                                      levels = c("control","low","high"))) %>% 
  filter(!is.na(hormone)) %>%
  group_by(hormone)

# plot set up
hormones <- c("#999999", "#E69F00", "brown2")
my_comparisons <- rev(list(c("control","low"),c("control","high-"),c("low","high")))

########### FIGURE 2: temperature and morphology effects of developmental 
# treatments on body size, condition, and mass at hatching;
fig1_A <- ggviolin(data_final, x = "hormone", y = "hatch_svl_mm",
                    color = "hormone", palette = hormones,
                    short.panel.labs = FALSE,
                    font.label = list(size = 12, color = "black"),
                    ggtheme = theme_bw())+ 
  geom_jitter(aes(color = hormone), width = 0.2, alpha = 0.6) +  # Adding raw data points with color and transparency
  
  # Adding mean and standard error
  stat_summary(
    mapping = aes(x = hormone, y = hatch_svl_mm),
    fun = "mean", geom = "point", size = 3, color = "black", alpha = 0.6) +
  stat_summary(
    mapping = aes(x = hormone, y = hatch_svl_mm),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black", alpha = 0.6) +
  
  stat_compare_means(comparisons = list(c("control","low"), c("control","high"), c("low","high"))) +
  stat_compare_means(method = "anova")+
  labs(x = NULL, y = "Hatchling SVL (mm)") +
  labs(color='CORT Treatment')+
  scale_y_continuous(breaks=seq(14, 22, 2), limits = c(14, 22))+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = "none")
# B) hatchling mass * hormone
Fig1_B <- ggviolin(data_final, x = "hormone", y = "hatch_mass_g",
                    color = "hormone", palette = hormones,
                    short.panel.labs = FALSE,
                    font.label = list(size = 12, color = "black"),
                    ggtheme = theme_bw()) +
  geom_jitter(aes(color = hormone), width = 0.2, alpha = 0.4) +  # Adding raw data points with color and transparency
  
  # Adding mean and standard error
  stat_summary(
    mapping = aes(x = hormone, y = hatch_mass_g),
    fun = "mean", geom = "point", size = 3, color = "black", alpha = .6) +
  stat_summary(
    mapping = aes(x = hormone, y = hatch_mass_g),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black", alpha = 0.6) +
  stat_compare_means(comparisons = list(c("control","low"), c("control","high"), c("low","high"))) +
  stat_compare_means(method = "anova") +
  labs(x = NULL, y = "Hatchling mass (g)") +
  labs(color='CORT Treatment')+
  scale_y_continuous(breaks=seq(0.06, 0.20, .02), limits = c(0.06,0.20))+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = c(0.99, 0.99),  # Positions the legend inside the plot
        legend.justification = c("right", "top"), # Justifies the legend's position
        legend.background = element_blank(),
        legend.key = element_blank(),
        legend.box = element_blank(),
        legend.text = element_text(size = 7),
        legend.title = element_text(size =8))

fig1 <- plot_grid(fig1_A, Fig1_B, ncol = 2, align = "h", labels = c("A", "B"))
fig1
```

```{r, fig-Figure_2}
#| label: fig-Figure_2
#| fig-cap: "How developmental temperature effects mass (panel A) and body condition (panel B) of hatchling lizards. Colors indicate the incubation temperature that eggs were reared in. Means and SE intervals are provided along with the p-value. Dashed horizontal line in Panel B indicates average condition, points that fall above the line are considered good condition and points below line are considered poor. Means and SE intervals are provided along with the p-value for each contrast."
#| warning: FALSE
#| echo: FALSE
#| fig-width: 9
#| fig-height: 7
#| fig-align: left
data_final <- read.csv(here("Kwild_code/data/final_analysis_data.csv"))

data_final  <- data_final%>% 
  mutate(data_final, hormone = factor(hormone, 
                                      levels = c("control","low","high"))) %>% 
  filter(!is.na(hormone)) %>%
  group_by(hormone)

# plot set up
temps <- c("Blue", "Red")
hormones <- c("#999999", "#E69F00", "brown2")
my_comparisons <- rev(list(c("control","low"),c("control","high-"),c("low","high")))


fig2_A <- ggviolin(data_final, x = "temp", y = "hatch_mass_g",
                    color = "temp", palette = temps,
                    short.panel.labs = FALSE,
                    font.label = list(size = 14, color = "black"),
                    ggtheme = theme_bw()) +
  
  geom_jitter(aes(color = temp), width = 0.2, alpha = 0.4) + 
  stat_summary(
    mapping = aes(x = temp, y = hatch_mass_g),
    fun = "mean", geom = "point", size = 2, color = "black", alpha = .5) +
  stat_summary(
    mapping = aes(x = temp, y = hatch_mass_g),
    fun.data = "mean_se", geom = "errorbar", width = .1, color = "black", alpha = .5) +
  stat_compare_means(method = "anova") +
  labs(x = "Temperature (°C)", y = "Hatchling mass (g)") +
  labs(color='Temperature Treatment')+
  scale_y_continuous(breaks=seq(0.06, 0.18, .02), limits = c(0.06,0.18)) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = "none")

# body condition and temp
fig2_B <- ggviolin(data_final, x = "temp", y = "hatch_bc_residuals",
                   color = "temp", palette = temps,
                   short.panel.labs = FALSE,
                   font.label = list(size = 14, color = "black"),
                   ggtheme = theme_bw()) + 
  geom_jitter(aes(color = temp), width = 0.2, alpha = 0.4) +  
  stat_summary(
    mapping = aes(x = temp, y = hatch_bc_residuals),
    fun = "mean", geom = "point", size = 2, color = "black", alpha = .5 ) +
  stat_summary(
    mapping = aes(x = temp, y = hatch_bc_residuals),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black", alpha = .5) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "black") +
  stat_compare_means(method = "anova", vjust = -.1, hjust = .5)+ 
  labs(x = "Temperature (°C)", y = "BCI") +
  labs(color='Incubation Treatment')+
  scale_y_continuous(breaks=seq(-0.06, 0.06, 0.02), limits = c(-0.06, 0.06))+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = c(0.99, 0.99),  # Positions the legend inside the plot
        legend.justification = c("right", "top"), # Justifies the legend's position
        legend.background = element_blank(),
        legend.key = element_blank(),
        legend.box = element_blank(),
        legend.text = element_text(size = 6),
        legend.title = element_text(size = 8))

fig2 <- plot_grid(fig2_A, fig2_B, ncol = 2, align = "h", labels = c("A", "B"))
fig2
```

\newpage

### *b) The effects of developmental treatments (temperature and CORT) on juvenile Physiology - CORT, T4, and mitochondrial function*

```{r}
#| echo: false
  #### 3.	What are the developmental temperature and hormonal treatment on juvenile CORT, T4, and Testosterone)?
  #### CORT_development: CORT does not vary across temp and hormone treatment - NS
  #### CORT_growth: CORT correlates with mass growth rate 
  #### T4_development: T4 varies across sex but not developmental treatments (temp or hormone)
  #### T4_growth: T4 correlates with mass growth rate 

  # final raw data that have morphometrics (svl, mass, and BCI residuals) across life stage 
  data_final <- read.csv(here("Kwild_code/data/final_analysis_data_quarto.csv")) %>%
  filter(juv3_Sample_volume_ul >= 4 ) # remove values below 4 ul juv3_Sample_volume_ul


  ### individual data
  # cort data  
  cort_dat <- data_final %>%
    drop_na(juv3_CORT_Final_Hormone_ng_mL, temp, hormone, juv3_HandlingTime_sec)
  # T4 data
  t4_dat <- data_final %>%
    drop_na(juv3_T4_corrected_ng_mL, temp, hormone, Lizard_ID) 
  
  # oroboros data
  mito_dat <- data_final %>%
  dplyr::select(c("Lizard_ID", "temp", "hormone", "sex", "juv3_bc_resid",
                  "juv3_inject_time_sec", "juv3_liver_time_sec", "juv3_oroboros", 
                  "juv3_chamber","juv3_basal_corrected.pmol..sec.ng..", 
                  "juv3_adp_corrected.pmol..sec.ng..", "juv3_oligo_corrected.pmol..sec.ng..", 
                  "juv3_fccp_corrected.pmol..sec.ng..", "juv3_RCR.L.R.", "juv3_RCR.R.ETS.",
                  "juv3_oroboros_comments", "juv3_RCR.L.ETS.")) %>% 
  dplyr::rename(inject_time_sec = juv3_inject_time_sec, 
                chamber = juv3_chamber,
                basal_corrected_pmol = juv3_basal_corrected.pmol..sec.ng..,
                oligo_corrected_pmol = juv3_oligo_corrected.pmol..sec.ng..,
                fccp_corrected_pmol = juv3_fccp_corrected.pmol..sec.ng..,
                adp_corrected_pmol =  juv3_adp_corrected.pmol..sec.ng..,
                RCR_L_R = juv3_RCR.L.R., 
                RCR_R_ETS = juv3_RCR.R.ETS.,
                RCR_L_ETS = juv3_RCR.L.ETS., 
                oroboros_comments = juv3_oroboros_comments) %>% 
  mutate(ID_and_Comments = paste(Lizard_ID, oroboros_comments, sep = ": "),
         state2_state3 = basal_corrected_pmol/basal_corrected_pmol)


  ###########
  # CORT
  # 1) treatments- how does cort vary across temp and hormone treatment
  cort_development_mod <- readRDS(here("Kwild_code/models/cort_development_mod.RDS"))
  cort_development_mod_summ <- summary(cort_development_mod)
  cort_development_mod_summ <- as.data.frame(round(cort_development_mod_summ$coefficients, 
                                            digits = 2))
  cort_development_mod_anova <- as.data.frame(Anova(cort_development_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))
  
  # No differences
cort_development_mod_emm <- emmeans(cort_development_mod, pairwise ~ hormone)
cort_development_mod_emm_value <- cort_development_mod_emm$emmeans
cort_development_mod_emm_cont <- data.frame(cort_development_mod_emm$contrasts)


  
  # 2)  MASS growth - does Juvinile cort correlate with mass growth rate and how does this vary across temp and hormone treatment
  cort_mass_growth_mod <- readRDS(here("Kwild_code/models/cort_mass_growth_mod.RDS"))
  cort_mass_growth_mod_summ <- summary(cort_mass_growth_mod)
  cort_mass_growth_mod_summ <- as.data.frame(round(cort_mass_growth_mod_summ$coefficients, 
                                            digits = 2))
  cort_mass_growth_mod_anova <- as.data.frame(anova(cort_mass_growth_mod)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))

   # 3)  SVL growth - does Juvinile cort correlate with mass growth rate and how does this vary across temp and hormone treatment
  cort_svl_growth_mod <- readRDS(here("Kwild_code/models/cort_svl_growth_mod.RDS"))
  cort_svl_growth_mod_summ <- summary(cort_svl_growth_mod)
  cort_svl_growth_mod_summ <- as.data.frame(round(cort_svl_growth_mod_summ$coefficients, 
                                            digits = 2))
  cort_svl_growth_mod_anova <- as.data.frame(anova(cort_svl_growth_mod)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))
  
  
  ###########
  # T4
  # 1) treatments -  does T4 vary across temp, hormone treatment and sex: Sex differences
  T4_sex_temp_hormone_mod <- readRDS(here("Kwild_code/models/T4_temp_hormone_sex_mod.RDS"))
  T4_sex_temp_hormone_mod_summ <- summary(T4_sex_temp_hormone_mod)
  T4_sex_temp_hormone_mod_summ <- as.data.frame(round(T4_sex_temp_hormone_mod_summ$coefficients, 
                                            digits = 2))
  T4_sex_temp_hormone_mod_anova <- as.data.frame(Anova(T4_sex_temp_hormone_mod, 
                                                       type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))
  
  T4_temp_hormone_sex_mod_emm <- emmeans(T4_sex_temp_hormone_mod, pairwise ~ sex)
  T4_temp_hormone_sex_mod_emm_value <- T4_temp_hormone_sex_mod_emm$emmeans
  T4_temp_hormone_sex_mod_emm_cont <- T4_temp_hormone_sex_mod_emm$contrasts %>% 
    as.data.frame()

  # 2) MASS growth and the interaction between T4 and cort
  T4_mass_growth_mod <- readRDS(here("Kwild_code/models/T4_mass_growth_mod.RDS"))
  T4_mass_growth_mod_summ <- summary(T4_mass_growth_mod)
  T4_mass_growth_mod_summ <- as.data.frame(round(T4_mass_growth_mod_summ$coefficients, 
                                            digits = 2))
  T4_mass_growth_mod_anova <- as.data.frame(Anova(T4_mass_growth_mod, 
                                                  type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))
  

###########
# Mito function
mito_dat <- read.csv(here("Kwild_code/data/final_mito_dat_clean.csv"))

##########
# RCR_L_ETS effects by developmental environment and sex (sex X hormone) with inject_time_sec as a covariate   
# interaction removed; no effect on covariate of injection time
RCR_L_ETS_sex_temp_hormone_mod <- readRDS(here("Kwild_code/models/RCR_L_ETS_sex_temp_hormone_mod.RDS"))
RCR_L_ETS_sex_temp_hormone_mod_summ <- summary(RCR_L_ETS_sex_temp_hormone_mod)
RCR_L_ETS_sex_temp_hormone_mod_summ <- as.data.frame(round(RCR_L_ETS_sex_temp_hormone_mod_summ$coefficients, 
                                            digits = 2))
RCR_L_ETS_sex_temp_hormone_mod_anova <- as.data.frame(Anova(RCR_L_ETS_sex_temp_hormone_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))


##########
# RCR (R/ETS): RCR_R_ETS effects by developmental environment and sex (sex:hormone) 
# with inject_time_sec as a covariate   
# interaction removed; no effect on covariate of injection time; Sex effects but no developmental effects
RCR_R_ETS_sex_temp_hormone_mod <- readRDS(here("Kwild_code/models/RCR_R_ETS_sex_temp_hormone_mod.RDS"))
RCR_R_ETS_sex_temp_hormone_mod_summ <- summary(RCR_R_ETS_sex_temp_hormone_mod)
RCR_R_ETS_sex_temp_hormone_mod_summ <- as.data.frame(round(RCR_R_ETS_sex_temp_hormone_mod_summ$coefficients, 
                                                           digits = 2))
RCR_R_ETS_sex_temp_hormone_mod_anova <- as.data.frame(Anova(RCR_R_ETS_sex_temp_hormone_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))
# No differences across treatments or  covariate; but sex effects
RCR_R_ETS_sex_temp_hormone_mod_emm <- emmeans(RCR_R_ETS_sex_temp_hormone_mod, pairwise ~ sex)
RCR_R_ETS_sex_temp_hormone_mod_emm_value <- RCR_R_ETS_sex_temp_hormone_mod_emm$emmeans
RCR_R_ETS_sex_temp_hormone_mod_emm_cont <- data.frame(RCR_R_ETS_sex_temp_hormone_mod_emm$contrasts)


#########
### RCR (L/ETS) VS CORT and T4
## RCR (L/ETS) VS CORT - NO EFFECTS
# with inject_time_sec as a covariate   
# interaction removed; no effect on covariate of injection time; Sex effects but no developmental effects
RCR_L_ETS_CORT_mod <- readRDS(here("Kwild_code/models/RCR_L_ETS_CORT_mod.RDS"))
RCR_L_ETS_CORT_mod_summ <- summary(RCR_L_ETS_CORT_mod)
RCR_L_ETS_CORT_mod_summ <- as.data.frame(round(RCR_L_ETS_CORT_mod_summ$coefficients, 
                                               digits = 2))
RCR_L_ETS_CORT_mod_anova <- as.data.frame(Anova(RCR_L_ETS_CORT_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))


## RCR (R/ETS) VS T4 - No differences!
# with inject_time_sec as a covariate   
# interaction removed; no effect on covariate of injection time; # No differences across treatments effects
RCR_L_ETS_T4_mod <- readRDS(here("Kwild_code/models/RCR_L_ETS_T4_mod.RDS"))
RCR_L_ETS_T4_mod_summ <- summary(RCR_L_ETS_T4_mod)
RCR_L_ETS_T4_mod_summ <- as.data.frame(round(RCR_L_ETS_T4_mod_summ$coefficients, 
                                             digits = 2))
RCR_L_ETS_T4_mod_anova <- as.data.frame(Anova(RCR_L_ETS_T4_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))
# No differences across treatments effects



#########
### RCR (R/ETS) VS CORT and T4
## RCR (R/ETS) VS CORT - no effect
RCR_R_ETS_CORT_mod <-readRDS(here("Kwild_code/models/RCR_R_ETS_CORT_mod.RDS"))
RCR_R_ETS_CORT_mod_summ <- summary(RCR_R_ETS_CORT_mod)
RCR_R_ETS_CORT_mod_summ <- as.data.frame(round(RCR_R_ETS_CORT_mod_summ$coefficients, 
                                                           digits = 2))
RCR_R_ETS_CORT_mod_anova <- as.data.frame(Anova(RCR_R_ETS_CORT_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))


## RCR (R/ETS) VS T4 - negative effect
RCR_R_ETS_T4_mod <- readRDS(here("Kwild_code/models/RCR_R_ETS_T4_mod.RDS"))
RCR_R_ETS_T4_mod_summ <- summary(RCR_R_ETS_T4_mod)
RCR_R_ETS_T4_mod_summ <- as.data.frame(round(RCR_R_ETS_T4_mod_summ$coefficients, 
                                               digits = 2))
RCR_R_ETS_T4_mod_anova <- as.data.frame(Anova(RCR_R_ETS_T4_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2))


```

Juvenile cortisol levels (CORT ng/mL) were were not influenced by their developmental environment of temperature ($F_{`r cort_development_mod_anova$Df[1]`,`r cort_development_mod_anova$Df[7]`}$ = `r cort_development_mod_anova[3,3]`, p = `r p_value(cort_development_mod_anova[3,4])`), CORT ($F_{`r cort_development_mod_anova$Df[2]`,`r cort_development_mod_anova$Df[7]`}$ = `r cort_development_mod_anova[2,3]`, p = `r p_value(cort_development_mod_anova[2,4])`) or between sex ($F_{`r cort_development_mod_anova$Df[4]`,`r cort_development_mod_anova$Df[7]`}$ = `r cort_development_mod_anova[4,3]`, p = `r p_value(cort_development_mod_anova[4,4])`). Because of documented effect of temperature on developmental time, body size was used as a scaled covariate as a proxy for age in the model and there was a significant relationship as expected ($F_{`r cort_development_mod_anova$Df[6]`,`r cort_development_mod_anova$Df[7]`}$ = `r cort_development_mod_anova[6,3]`, p = `r p_value(cort_development_mod_anova[6,4])`). The other covariate, handling time (sec), had no significant relationship with CORT levels ($F_{`r cort_development_mod_anova$Df[5]`,`r cort_development_mod_anova$Df[7]`}$ = `r cort_development_mod_anova[5,3]`, p = `r p_value(cort_development_mod_anova[5,4])`). Juvenile CORT levels were related with SVL growth rates, where juvenile CORT levels significantly increased with SVL growth (@fig-Figure_3 A; $F_{`r cort_svl_growth_mod_anova$Df[1]`,`r cort_svl_growth_mod_anova$Df[5]`}$ = `r cort_svl_growth_mod_anova[1,4]`, p = `r p_value(cort_svl_growth_mod_anova[1,5])`). There was no effect of developmental temperature ($F_{`r cort_svl_growth_mod_anova$Df[2]`,`r cort_svl_growth_mod_anova$Df[5]`}$ = `r cort_svl_growth_mod_anova[2,4]`, p = `r p_value(cort_svl_growth_mod_anova[2,5])`), CORT developmental environment ($F_{`r cort_svl_growth_mod_anova$Df[3]`,`r cort_svl_growth_mod_anova$Df[5]`}$ = `r cort_svl_growth_mod_anova[3,4]`, p = `r p_value(cort_svl_growth_mod_anova[3,5])`), or sex ($F_{`r cort_svl_growth_mod_anova$Df[4]`,`r cort_svl_growth_mod_anova$Df[5]`}$ = `r cort_svl_growth_mod_anova[4,4]`, p = `r p_value(cort_svl_growth_mod_anova[4,5])`) on SVL growth rate. Similarly there was a positive relationship between juvenile CORT levels and mass growth rates (@fig-Figure_3 B; $F_{`r cort_mass_growth_mod_anova$Df[1]`,`r cort_mass_growth_mod_anova$Df[5]`}$ = `r cort_mass_growth_mod_anova[1,4]`, p = `r p_value(cort_mass_growth_mod_anova[1,5])`). There was no effect of developmental temperature ($F_{`r cort_mass_growth_mod_anova$Df[2]`,`r cort_mass_growth_mod_anova$Df[5]`}$ = `r cort_mass_growth_mod_anova[2,4]`, p = `r p_value(cort_mass_growth_mod_anova[2,5])`), CORT developmental environment ($F_{`r cort_mass_growth_mod_anova$Df[3]`,`r cort_mass_growth_mod_anova$Df[5]`}$ = `r cort_mass_growth_mod_anova[3,4]`, p = `r p_value(cort_mass_growth_mod_anova[3,5])`), or sex ($F_{`r cort_mass_growth_mod_anova$Df[4]`,`r cort_mass_growth_mod_anova$Df[5]`}$ = `r cort_mass_growth_mod_anova[4,4]`, p = `r p_value(cort_mass_growth_mod_anova[4,5])`) on mass growth rate. 

Juvenile thyroxine levels (T4 ng/mL) were significantly different between male and female lizards (@fig-Figure_4; $F_{`r T4_sex_temp_hormone_mod_anova$Df[4]`,`r T4_sex_temp_hormone_mod_anova$Df[5]`}$ = `r T4_sex_temp_hormone_mod_anova[4,3]`, p = `r p_value(T4_sex_temp_hormone_mod_anova[4,4])`). On average, T4 levels for male lizards was `r T4_temp_hormone_sex_mod_emm_cont[,"estimate"]` ng/mL higher than female lizards (±SE: `r T4_temp_hormone_sex_mod_emm_cont[1,3]`, *t*-value = `r T4_temp_hormone_sex_mod_emm_cont[,"t.ratio"]`, df = `r T4_temp_hormone_sex_mod_emm_cont[,"df"]`, p = `r p_value(T4_temp_hormone_sex_mod_emm_cont[,"p.value"])`). There were no differences in T4 levels when comparing developmental environment of temperature ($F_{`r T4_sex_temp_hormone_mod_anova$Df[2]`,`r T4_sex_temp_hormone_mod_anova$Df[5]`}$ = `r T4_sex_temp_hormone_mod_anova[2,3]`, p = `r p_value(T4_sex_temp_hormone_mod_anova[2,4])`) or CORT developmental environment ($F_{`r T4_sex_temp_hormone_mod_anova$Df[3]`,`r T4_sex_temp_hormone_mod_anova$Df[5]`}$ = `r T4_sex_temp_hormone_mod_anova[3,3]`, p = `r p_value(T4_sex_temp_hormone_mod_anova[3,4])`). We tested to see how T4 levels, CORT levels, and their interaction were affected by mass growth rate. In this model we also accounted for developmental temperature. We found a significant interaction between CORT and T4 levels (@fig-Figure_5; $F_{`r T4_mass_growth_mod_anova$Df[5]`,`r T4_mass_growth_mod_anova$Df[6]`}$ = `r T4_mass_growth_mod_anova[5,3]`, p = `r p_value(T4_mass_growth_mod_anova[5,4])`). There was no developmental effect of temperature ($F_{`r T4_mass_growth_mod_anova$Df[1]`,`r T4_mass_growth_mod_anova$Df[6]`}$ = `r T4_mass_growth_mod_anova[4,3]`, p = `r p_value(T4_mass_growth_mod_anova[4,4])`). 

Respiratory control ratios RCR$_{L/ETS}$ and RCR$_{R/ETS}$ for juvenile lizards were used to determine if mitochondrial efficiency was effected by developmental temperature, CORT developmental environment, or sex. There was no effect on CORT developmental environment (@fig-Figure_6 A; $F_{`r RCR_L_ETS_sex_temp_hormone_mod_anova$Df[2]`,`r RCR_L_ETS_sex_temp_hormone_mod$df.residual`}$ = `r RCR_L_ETS_sex_temp_hormone_mod_anova[2,1]`, p = `r p_value(RCR_L_ETS_sex_temp_hormone_mod_anova[2,3])`), developmental temperature (@fig-Figure_6 B; $F_{`r RCR_L_ETS_sex_temp_hormone_mod_anova$Df[1]`,`r RCR_L_ETS_sex_temp_hormone_mod$df.residual`}$ = `r RCR_L_ETS_sex_temp_hormone_mod_anova[1,1]`, p = `r p_value(RCR_L_ETS_sex_temp_hormone_mod_anova[1,3])`), or sex ($F_{`r RCR_L_ETS_sex_temp_hormone_mod_anova$Df[2]`,`r RCR_L_ETS_sex_temp_hormone_mod$df.residual`}$ = `r RCR_L_ETS_sex_temp_hormone_mod_anova[3,1]`, p = `r p_value(RCR_L_ETS_sex_temp_hormone_mod_anova[3,3])`) on RCR$_{L/ETS}$ ratios. The covariate, injection time, was non significant ($F_{`r RCR_L_ETS_sex_temp_hormone_mod_anova$Df[4]`,`r RCR_L_ETS_sex_temp_hormone_mod$df.residual`}$ = `r RCR_L_ETS_sex_temp_hormone_mod_anova[4,1]`, p = `r p_value(RCR_L_ETS_sex_temp_hormone_mod_anova[4,3])`). However there were sex differences when comparing RCR$_{R/ETS}$ ratios (@fig-Figure_7; $F_{`r RCR_R_ETS_sex_temp_hormone_mod_anova$Df[3]`,`r RCR_R_ETS_sex_temp_hormone_mod_anova$df.residual`}$ = `r RCR_R_ETS_sex_temp_hormone_mod_anova[3,1]`, p = `r p_value(RCR_R_ETS_sex_temp_hormone_mod_anova[3,3])`), where on average, RCR$_{R/ETS}$ ratios for female lizards was `r RCR_R_ETS_sex_temp_hormone_mod_emm_cont[,"estimate"]` lower than male lizards (±SE: `r RCR_R_ETS_sex_temp_hormone_mod_emm_cont[1,3]`, *t*-value = `r RCR_R_ETS_sex_temp_hormone_mod_emm_cont[,"t.ratio"]`, df = `r RCR_R_ETS_sex_temp_hormone_mod_emm_cont[,"df"]`, p = `r p_value(RCR_R_ETS_sex_temp_hormone_mod_emm_cont[,"p.value"])`). There were no detectable effects of developmental temperature ($F_{`r RCR_R_ETS_sex_temp_hormone_mod_anova$Df[1]`,`r RCR_R_ETS_sex_temp_hormone_mod$df.residual`}$ = `r RCR_R_ETS_sex_temp_hormone_mod_anova[1,1]`, p = `r p_value(RCR_R_ETS_sex_temp_hormone_mod_anova[1,3])`) or CORT developmental environment ($F_{`r RCR_R_ETS_sex_temp_hormone_mod_anova$Df[2]`,`r RCR_R_ETS_sex_temp_hormone_mod$df.residual`}$ = `r RCR_R_ETS_sex_temp_hormone_mod_anova[2,1]`, p = `r p_value(RCR_R_ETS_sex_temp_hormone_mod_anova[2,3])`). The covariate, injection time, was non significant ($F_{`r RCR_R_ETS_sex_temp_hormone_mod_anova$Df[4]`,`r RCR_L_ETS_sex_temp_hormone_mod$df.residual`}$ = `r RCR_R_ETS_sex_temp_hormone_mod_anova[4,1]`, p = `r p_value(RCR_R_ETS_sex_temp_hormone_mod_anova[4,3])`) 

The relationship between respiratory control ratios (RCR$_{L/ETS}$ and RCR$_{R/ETS}$) and juvenile hormone measurements (CORT and T4) was compared RCR$_{L/ETS}$ ratios had no relationship between CORT levels (@fig-Figure_8 A; $F_{`r RCR_L_ETS_CORT_mod_anova$Df[1]`,`r RCR_L_ETS_sex_temp_hormone_mod$df.residual`}$ = `r RCR_L_ETS_CORT_mod_anova[2,3]`, p = `r p_value(RCR_L_ETS_CORT_mod_anova[2,4])`), but  RCR$_{L/ETS}$ significantly decreased as T4 levels increased (@fig-Figure_8 B; $F_{`r RCR_L_ETS_T4_mod_anova$Df[1]`,`r RCR_L_ETS_sex_temp_hormone_mod$df.residual`}$ = `r RCR_L_ETS_T4_mod_anova[2,3]`, p = `r p_value(RCR_L_ETS_T4_mod_anova[2,4])`). Similarly, there was no relationship between RCR$_{L/ETS}$ ratios and CORT levels (@fig-Figure_8 C; $F_{`r RCR_R_ETS_CORT_mod_anova$Df[1]`,`r RCR_R_ETS_CORT_mod_anova$df.residual`}$ = `r RCR_R_ETS_CORT_mod_anova[2,3]`, p = `r p_value(RCR_R_ETS_CORT_mod_anova[2,4])`), but RCR$_{L/ETS}$ marginally decreased as T4 levels increased (@fig-Figure_8 D; $F_{`r RCR_R_ETS_T4_mod_anova$Df[1]`,`r RCR_R_ETS_T4_mod_anova$Df[3]`}$ = `r RCR_R_ETS_T4_mod_anova[2,3]`, p = `r p_value(RCR_R_ETS_T4_mod_anova[2,4])`) 




```{r, fig-Figure_3}
#| label: fig-Figure_3
#| fig-cap: "The relationship final cort measurements and juvenile growth rate. Growth period was determined from hatchling to final measurement (mean = 467 days). Panel A shows SVL change (mm/d) and panel B shows mass change (g/d). Colors show the incubation temperature during development and symbols show the hormonal treatment during development. Correlation coefficient (r) and p value (p) are provided in each plot. Overall there were no relationships between incubation temperature during development or hormonal treatment during development and final CORT values. However there was an overall positive relationship between final CORT measurements and growth rate."
#| echo: FALSE
#| warning: FALSE
#| fig-width: 10
#| fig-height: 7
#| fig-align: center
data_final <- read.csv(here("Kwild_code/data/final_analysis_data.csv"))
cort_dat <- data_final %>%
  drop_na(juv3_CORT_Final_Hormone_ng_mL, temp, hormone, juv3_HandlingTime_sec)

# function for plot to show pvalue and correlation coefficient 
calc_cor <- function(data, x, y) {
  cor_test <- cor.test(data[[x]], data[[y]])
  cor <- cor_test$estimate
  p_value <- cor_test$p.value
  return(data.frame(cor = cor, p_value = p_value))
}

# Calculate correlation and p-values for each plot
cor_res_A <- calc_cor(cort_dat, "hatch_juv3_SVL_growth", "juv3_CORT_Final_Hormone_ng_mL")
cor_res_B <- calc_cor(cort_dat, "hatch_juv3_MASS_growth", "juv3_CORT_Final_Hormone_ng_mL")

# Adding p-values and correlation coefficients on the plots
fig3_A <- ggplot(cort_dat, aes(x = hatch_juv3_SVL_growth, y = juv3_CORT_Final_Hormone_ng_mL)) +
  geom_point(aes(color = as.factor(temp), shape = hormone), size = 2) + 
  geom_smooth(method = "lm", se = FALSE, color = "black", linetype = 2) +
  labs(x = "SVL growth rate (mm/d)", y = "CORT Final Hormone (ng/mL)", 
       color = "Temperature", shape = "Treatment") +
  scale_color_discrete(name = "Temperature") + 
  geom_text(aes(x = .045, y = 500, 
                label = sprintf("r = %.2f, p = %.3f", cor_res_A$cor, cor_res_A$p_value)), 
            hjust = 0, vjust = 1) + # Adjust hjust and vjust to position the text
  theme_bw() +
  theme(legend.position = "none", 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))


# Repeat similar process for fig4_B
fig3_B <- ggplot(cort_dat, aes(x = hatch_juv3_MASS_growth, y = juv3_CORT_Final_Hormone_ng_mL)) +
  geom_point(aes(color = as.factor(temp), shape = hormone), size = 2) + 
  geom_smooth(method = "lm", se = FALSE, color = "black", linetype = 2) +
  labs(x = "Mass growth rate (g/d)", y = NULL, 
       color = "Temperature", shape = "Treatment") +
  scale_color_discrete(name = "Temperature") + 
  geom_text(aes(x = .0025, y = 500, 
                label = sprintf("r = %.2f, p = %.3f", cor_res_B$cor, cor_res_B$p_value)), 
            hjust = 0, vjust = 1) + # Adjust hjust and vjust to position the text
  theme_bw() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = c(0.99, 0.99),  # Positions the legend inside the plot
        legend.justification = c("right", "top"), # Justifies the legend's position
        legend.background = element_blank(),
        legend.key = element_blank(),
        legend.box = element_blank(),
        legend.text = element_text(size = 6),
        legend.title = element_text(size = 8))

fig3 <- plot_grid(fig3_A, fig3_B, ncol = 2, align = "h", labels = c("A", "B"))
fig3
```

```{r, fig-Figure_4}
#| label: fig-Figure_4
#| fig-cap: "Differences in T4 levels between male (red) and female (blue) lizards. Means and SE intervals are provided along with the p-value."
#| echo: FALSE
#| warning: FALSE
#| fig-width: 10
#| fig-height: 7
#| fig-align: right
# Bring in T4 data and the model
t4_dat <- read.csv(here("Kwild_code/data/final_analysis_data.csv")) %>% 
   drop_na(juv3_T4_corrected_ng_mL, temp, hormone, Lizard_ID)

fig4 <- ggviolin(t4_dat, x = "sex", y = "juv3_T4_corrected_ng_mL",
                   color = "sex", short.panel.labs = FALSE,
                   font.label = list(size = 12, color = "black"),
                   ggtheme = theme_bw()) + 
  geom_jitter(aes(color = sex), width = 0.2, alpha = 0.4) +  
  stat_summary(
    mapping = aes(x = sex, y = juv3_T4_corrected_ng_mL),
    fun = "mean", geom = "point", size = 2, color = "black", alpha = .5 ) +
  stat_summary(
    mapping = aes(x = sex, y = juv3_T4_corrected_ng_mL),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black", alpha = .5) +
  stat_compare_means(method = "anova", vjust = -.1, hjust = .5)+ 
  labs(x = "Sex", y = "T4 (ng/mL)") +
  labs(color='Sex')+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = c(0.99, 0.99),  # Positions the legend inside the plot
        legend.justification = c("right", "top"), # Justifies the legend's position
        legend.background = element_blank(),
        legend.key = element_blank(),
        legend.box = element_blank(),
        legend.text = element_text(size = 6),
        legend.title = element_text(size = 8))

fig4
```

```{r, fig-Figure_5}
#| label: fig-Figure_5
#| fig-cap: " Predicted parametric contour plots of mass growth rate as a function of our standardized traits from generalized linear models. Colors indicate the mass growth rate of individual lizards: dark purple = relative growth rate -1.0 (g) and below, purple = relative growth rate -0.5 and 0.5 (g), red = relative growth rate 0.5 and 1.5 (g), and yellow = relative growth rate greater than 1.5 (g)."
#| echo: FALSE
#| warning: FALSE
#| fig-width: 10
#| fig-height: 7
#| fig-align: right
# Bring in T4 data and the model
t4_dat <- read.csv(here("Kwild_code/data/final_analysis_data.csv")) %>% 
   drop_na(juv3_T4_corrected_ng_mL, temp, hormone, Lizard_ID)

T4_mass_growth_mod <-readRDS(here("Kwild_code/models/T4_mass_growth_mod.RDS"))
# PLOT: predicitions: growth and T4 and cort
newdata <- data.frame(`juv3_CORT_Final_Hormone_ng_mL` = seq(from = min(t4_dat$juv3_CORT_Final_Hormone_ng_mL), 
                                                            to = max(t4_dat$juv3_CORT_Final_Hormone_ng_mL),
                                                            length.out = 100),
                      `juv3_T4_corrected_ng_mL` = rep(seq(from = min(t4_dat$juv3_T4_corrected_ng_mL), 
                                                          to = max(t4_dat$juv3_T4_corrected_ng_mL)), 
                                                      each = 100), temp = 23)

newdata$pred <- predict(T4_mass_growth_mod, newdata = newdata)

# another plot
s <- interp(x = newdata$juv3_T4_corrected_ng_mL, 
            y = newdata$juv3_CORT_Final_Hormone_ng_mL, 
            z = newdata$pred)
image.plot(s, xlab = "T4_ng_mL", ylab = "Cort_ng_mL", 
           las = 1, col = viridis(option = "magma", 50), 
           cex.axis = 1, axis.args = list(cex.axis = 1.5), cex.lab = 1.8,
           xlim = c(min(newdata$juv3_T4_corrected_ng_mL)+.012, 
                    max(newdata$juv3_T4_corrected_ng_mL)-.011),  # Explicitly defining x limits
           ylim = c(min(newdata$juv3_CORT_Final_Hormone_ng_mL)+8, 
                    max(newdata$juv3_CORT_Final_Hormone_ng_mL)))  # Explicitly defining y limits
contour(s, add = TRUE, col = "white")
```

```{r, fig-Figure_6}
#| label: fig-Figure_6
#| fig-cap: " RCR$_{L/ETS}$ model results from developmental environment - CORT (panel A) and temperature (panel B). These data are from the model which tested how RCR$_{L/ETS}$ varies across hormone, temperature, sex, and their interaction. Overall there was no significant effect on developmental environments (Temperature and CORT treatments) nor sex on RCR$_{L/ETS}$. We did not detect any interaction effects. We also found there was no relationship between inject time (sec) and RCR$_{L/ETS}$ levels. Means and SE intervals are provided along with the p-value."
#| warning: FALSE
#| echo: FALSE
#| fig-width: 9
#| fig-height: 7
#| fig-align: left

#### RCR_L_ETS effects by developmental environment and sex (sex X hormone) with inject_time_sec as a covariate   
# Bring in  data and the model
mito_dat <- read.csv(here("Kwild_code/data/final_mito_dat_clean.csv"))
# interaction removed; no effect on covariate of injection time
RCR_L_ETS_sex_temp_hormone_mod <- readRDS(here("Kwild_code/models/RCR_L_ETS_sex_temp_hormone_mod.RDS"))

########### FIGURE : developmental enviroments (CORT) and it's effects on RCR_L_ETS
# treatments on body size, condition, and mass at hatching;
temps <- c("Blue", "Red")
hormones <- c("#999999", "#E69F00", "brown2")
my_comparisons <- rev(list(c("control","low"),c("control","high-"),c("low","high")))

Fig_6A <- ggviolin(mito_dat, x = "hormone", y = "RCR_L_ETS",
                    color = "hormone", palette = hormones,
                    short.panel.labs = FALSE,
                    font.label = list(size = 12, color = "black"),
                    ggtheme = theme_bw())+ 
  geom_jitter(aes(color = hormone), width = 0.2, alpha = 0.6) +  # Adding raw data points with color and transparency
  
  # Adding mean and standard error
  stat_summary(
    mapping = aes(x = hormone, y = RCR_L_ETS),
    fun = "mean", geom = "point", size = 3, color = "black", alpha = 0.6) +
  stat_summary(
    mapping = aes(x = hormone, y = RCR_L_ETS),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black", alpha = 0.6) +
  
  stat_compare_means(comparisons = list(c("control","low"), c("control","high"), c("low","high"))) +
  stat_compare_means(method = "anova")+
  labs(x = NULL, y = "RCR (L/ETS)") +
  labs(color='CORT Treatment')+
  scale_y_continuous(breaks=seq(0, .6, .1), limits = c(-.2, .6))+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = "none")

Fig_6B<- ggviolin(mito_dat, x = "temp", y = "RCR_L_ETS",
                    color = "temp", palette = temps,
                    short.panel.labs = FALSE,
                    font.label = list(size = 12, color = "black"),
                    ggtheme = theme_bw())+ 
  geom_jitter(aes(color = temp), width = 0.2, alpha = 0.6) +  # Adding raw data points with color and transparency
  
  # Adding mean and standard error
  stat_summary(
    mapping = aes(x = temp, y = RCR_L_ETS),
    fun = "mean", geom = "point", size = 3, color = "black", alpha = 0.6) +
  stat_summary(
    mapping = aes(x = temp, y = RCR_L_ETS),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black", alpha = 0.6)  +
  stat_compare_means(method = "anova")+
  labs(x = NULL, y = "RCR (L/ETS)") +
  labs(color='Temperature Treatment')+
  scale_y_continuous(breaks=seq(-.1, .6, .1), limits = c(-.1, .6))+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = "none")

Fig_6 <- plot_grid(Fig_6A, Fig_6B, ncol = 2, align = "h", labels = c("A", "B"))
Fig_6
```

```{r, fig-Figure_7}
#| label: fig-Figure_7
#| fig-cap: " RCR$_{R/ETS}$ model results on the effects sex have on R$_{R/ETS}$. These data are from the model which tested how R$_{R/ETS}$ varies across hormone, temperature, sex, and their interaction. Overall males had a significantly higher R$_{R/ETS}$ values in comparision to females. There was no significant effect on developmental environments (Temperature and CORT treatments). We did not detect any interaction effects. We also found there was no relationship between inject time (sec) and R$_{R/ETS}$ levels. Means and SE intervals are provided along with the p-value."
#| warning: FALSE
#| echo: FALSE
#| fig-width: 9
#| fig-height: 7
#| fig-align: left

#### RCR_R_ETS effects by developmental environment and sex (sex X hormone) with inject_time_sec as a covariate   
# Bring in  data and the model
mito_dat <- read.csv(here("Kwild_code/data/final_mito_dat_clean.csv"))
# interaction removed; no effect on covariate of injection time
RCR_R_ETS_sex_temp_hormone_mod <- readRDS(here("Kwild_code/models/RCR_R_ETS_sex_temp_hormone_mod.RDS"))

########### FIGURE : developmental enviroments (CORT) and it's effects on RCR_R_ETS
# treatments on body size, condition, and mass at hatching;
Fig_7 <- ggviolin(mito_dat, x = "sex", y = "RCR_R_ETS",
                    color = "sex",
                    short.panel.labs = FALSE,
                    font.label = list(size = 12, color = "black"),
                    ggtheme = theme_bw())+ 
  geom_jitter(aes(color = sex), width = 0.2, alpha = 0.6) +  # Adding raw data points with color and transparency
  
  # Adding mean and standard error
  stat_summary(
    mapping = aes(x = sex, y = RCR_R_ETS),
    fun = "mean", geom = "point", size = 3, color = "black", alpha = 0.6) +
  stat_summary(
    mapping = aes(x = sex, y = RCR_R_ETS),
    fun.data = "mean_se", geom = "errorbar", width = 0.1, color = "black", alpha = 0.6) +
  stat_compare_means(method = "anova")+
  labs(x = NULL, y = "RCR (R/ETS)") +
  labs(color='sex')+
  scale_y_continuous(breaks=seq(-.2, .8, .1), limits = c(-.2, .8))+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"), 
        legend.position = "none")

Fig_7
```

```{r, fig-Figure_8}
#| label: fig-Figure_8
#| fig-cap: "Panels A and B show the relationship between R$_{L/ETS}$ and final hormone measurements (panel A: CORT & panel B: T4) for juvenile lizards. Panels C and D show the relationship between R$_{R/ETS}$ and final hormone measurements (panel C: CORT & panel D: T4) for juvenile lizards. Correlation coefficient (r) and p value (p) are provided in each plot."
#| warning: FALSE
#| echo: FALSE
#| fig-width: 9
#| fig-height: 7
#| fig-align: left

#### RCR_R_ETS effects by developmental environment and sex (sex X hormone) with inject_time_sec as a covariate   
# Bring in  data and the model
mito_dat <- read.csv(here("Kwild_code/data/final_mito_dat_clean.csv"))

# function for plot to show pvalue and correlation coefficient 
calc_cor <- function(data, x, y) {
  cor_test <- cor.test(data[[x]], data[[y]])
  cor <- cor_test$estimate
  p_value <- cor_test$p.value
  return(data.frame(cor = cor, p_value = p_value))
}

# RCR(L/ETS)  & RCR(R/ETS) Correlation plots
cor_res_A <- calc_cor(mito_dat, "CORT_Final_Hormone_ng_mL", "RCR_L_ETS")
cor_res_B <- calc_cor(mito_dat, "T4_corrected_ng_mL", "RCR_L_ETS")
cor_res_C <- calc_cor(mito_dat, "CORT_Final_Hormone_ng_mL", "RCR_R_ETS")
cor_res_D <- calc_cor(mito_dat, "T4_corrected_ng_mL", "RCR_R_ETS")

# Adding p-values and correlation coefficients on the plots
fig8_A <- ggplot(mito_dat, aes(x = CORT_Final_Hormone_ng_mL, y = RCR_L_ETS)) +
  geom_point(shape = 1, color = "black", size = 2) + 
  geom_smooth(method = "lm", se = FALSE, color = "black", linetype = 2) +
  labs(x = "CORT Final Hormone (ng/mL)", y = "RCR (L/ETS)") +
  scale_color_discrete(name = "Temperature") + 
  geom_text(aes(x = 300, y = .68, 
                label = sprintf("r = %.2f, p = %.3f", cor_res_A$cor, cor_res_A$p_value)), 
            hjust = 0, vjust = 1) + # Adjust hjust and vjust to position the text
  theme_bw() +
  theme(legend.position = "none", 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

# Adding p-values and correlation coefficients on the plots
fig8_B <- ggplot(mito_dat, aes(x = T4_corrected_ng_mL, y = RCR_L_ETS)) +
  geom_point(shape = 1, color = "black", size = 2) + 
  geom_smooth(method = "lm", se = FALSE, color = "black", linetype = 2) +
  labs(x = "T4_corrected_ng_mL", y = "RCR (L/ETS)") +
  scale_color_discrete(name = "Temperature") + 
  geom_text(aes(x = .7, y = .7, 
                label = sprintf("r = %.2f, p = %.3f", cor_res_B$cor, cor_res_B$p_value)), 
            hjust = 0, vjust = 1) + # Adjust hjust and vjust to position the text
  theme_bw() +
  theme(legend.position = "none", 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))


# Adding p-values and correlation coefficients on the plots
fig8_C <- ggplot(mito_dat, aes(x = CORT_Final_Hormone_ng_mL, y = RCR_R_ETS)) +
  geom_point(shape = 1, color = "black", size = 2) + 
  geom_smooth(method = "lm", se = FALSE, color = "black", linetype = 2) +
  labs(x = "CORT Final Hormone (ng/mL)", y = "RCR (R/ETS)") +
  scale_color_discrete(name = "Temperature") + 
  geom_text(aes(x = 300, y = .68, 
                label = sprintf("r = %.2f, p = %.3f", cor_res_C$cor, cor_res_C$p_value)), 
            hjust = 0, vjust = 1) + # Adjust hjust and vjust to position the text
  theme_bw() +
  theme(legend.position = "none", 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

# Adding p-values and correlation coefficients on the plots
fig8_D <- ggplot(mito_dat, aes(x = T4_corrected_ng_mL, y = RCR_R_ETS)) +
  geom_point(shape = 1, color = "black", size = 2) + 
  geom_smooth(method = "lm", se = FALSE, color = "black", linetype = 2) +
  labs(x = "T4_corrected_ng_mL", y = "RCR (R/ETS)") +
  scale_color_discrete(name = "Temperature") + 
  geom_text(aes(x = .7, y = .7, 
                label = sprintf("r = %.2f, p = %.3f", cor_res_D$cor, cor_res_D$p_value)), 
            hjust = 0, vjust = 1) + # Adjust hjust and vjust to position the text
  theme_bw() +
  theme(legend.position = "none", 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black"))

Fig_8 <- plot_grid(fig8_A, fig8_B, fig8_C, fig8_D, ncol = 2, nrow = 2,
                   align = "h", labels = c("A", "B", "C", "D"))
Fig_8
```

### *c) The effects of developmental treatments (temperature and CORT) on juvenile body size, mass, body condition (BCI), survival, and growth rate on juvenile lizards*

```{r}
#| echo: false
#### 3.	The effects of developmental treatments (temperature and CORT) on juvenile body size, mass, body condition (BCI), survival, and growth rate on juvenile lizards?
#### Juv3_BCI: Sex effect: male lower BCI than females - could be size difference
#### SURVIVAL: no differences between treatments
#### GROWTH SVL (Hatchling-Juvenile): No treatment effects
#### GROWTH MASS (Hatchling-Juvenile): No treatment effects

# final raw data that have morphometrics (svl, mass, and BCI residuals) across life stage 
data_final <- read.csv(here("Kwild_code/data/final_analysis_data.csv"))

###############
#### SVL growth rate: hatchling to Juv_3 
# SVL; interaction removed; no differences
overall_SVL_growth_mod <-  readRDS(here("Kwild_code/models/overall_SVL_growth_mod.RDS"))
# no treatment effects
overall_SVL_growth_mod_summ <- summary(overall_SVL_growth_mod)
overall_SVL_growth_mod_summ <- as.data.frame(round(overall_SVL_growth_mod_summ$coefficients, 
                                          digits = 2))
overall_SVL_mod_anova <- as.data.frame(Anova(overall_SVL_growth_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2)) 
# sex differences
overall_svl_growth_sex_mod_emm <- emmeans(overall_SVL_growth_mod, pairwise ~ sex)
overall_svl_growth_sex_mod_emm_value <- overall_svl_growth_sex_mod_emm$emmeans
overall_svl_growth_sex_mod_emm_cont <- as.data.frame(overall_svl_growth_sex_mod_emm$contrasts)


#### MASS growth rate: hatchling to Juv_3  
# Mass test; interaction removed
overall_mass_growth_mod <- readRDS(here("Kwild_code/models/growth4_mass_mod.RDS"))
overall_mass_growth_mod_summ <- summary(overall_mass_growth_mod)
overall_mass_growth_mod_summ <- as.data.frame(round(overall_mass_growth_mod_summ$coefficients, 
                                          digits = 2))
overall_mass_mod_anova <- as.data.frame(Anova(overall_mass_growth_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2)) 
# sex differences
overall_mass_growth_sex_mod_emm <- emmeans(overall_mass_growth_mod, pairwise ~ sex)
overall_mass_growth_sex_mod_emm_value <- overall_mass_growth_sex_mod_emm$emmeans
overall_mass_growth_sex_mod_emm_cont <- as.data.frame(overall_mass_growth_sex_mod_emm$contrasts)


###############
#### BCI ANALYSIS: Juv3 - BCI residuals; interaction removed
condition_juv3_mod <- readRDS(here("Kwild_code/models/condition_juv3_mod.RDS"))
# sex differences 
condition_juv3_mod_summ <- summary(condition_juv3_mod)
condition_juv3_mod_summ <- as.data.frame(round(condition_juv3_mod$coefficients, 
                                          digits = 2))
condition_juv3_mod_anova <- as.data.frame(Anova(condition_juv3_mod, type = 3)) %>% 
  mutate(across(where(is.numeric), round, digits = 2)) 
# sex differences
condition_juv3_sex_mod_emm <- emmeans(condition_juv3_mod, pairwise ~ sex)
condition_juv3_sex_mod_emm_value <- condition_juv3_sex_mod_emm$emmeans
condition_juv3_sex_mod_emm_cont <- as.data.frame(condition_juv3_sex_mod_emm$contrasts)


###############
#### Survival analysis to JUV 3 : hormone and temp 
##fisher test- filter out missing animals
survival<- data_final %>% 
  filter(liz_status_db != "MISSING")
survival_tbl <- table(survival$liz_status_db)
# analysis between temperature and treatment 
survival_hormone <- kruskal.test(liz_status_db ~ hormone, data = survival) 
survival_temp <- kruskal.test(liz_status_db ~ temp, data = survival)
# summaries: hormone & temp 
survival_results <- data.frame(
  Treatment = c("Hormone", "Temperature"),
  Test = c(survival_temp$method, survival_temp$method),
  Statistic = c(survival_hormone$statistic, survival_temp$statistic),
  P_value = c(survival_hormone$p.value, survival_temp$p.value))

```
Juvenile mass growth rate (mm/d) was significantly different between male and female lizards ($F_{`r overall_mass_mod_anova$Df[4]`,`r overall_mass_mod_anova$Df[6]`}$ = `r overall_mass_mod_anova[4,3]`, p = `r p_value(overall_mass_mod_anova[4,4])`). Where average mass growth rate was `r overall_mass_growth_sex_mod_emm_cont[1,2]` mg/d higher than male lizards (±SE:`r overall_mass_growth_sex_mod_emm_cont[1,3]`, *t*-value = `r overall_mass_growth_sex_mod_emm_cont$t.ratio`, df = `r overall_mass_growth_sex_mod_emm_cont$df`, p = `r p_value(overall_mass_growth_sex_mod_emm_cont$p.value)`). Mass growth rate  was not affected by developmental environment of temperature ($F_{`r overall_mass_mod_anova$Df[3]`,`r overall_mass_mod_anova$Df[6]`}$ = `r overall_mass_mod_anova[3,3]`, p = `r p_value(overall_mass_mod_anova[3,4])`) or CORT developmental environment ($F_{`r overall_mass_mod_anova$Df[2]`,`r overall_mass_mod_anova$Df[6]`}$ = `r overall_mass_mod_anova[2,3]`, p = `r p_value(overall_mass_mod_anova[2,4])`). Similarly, juvenile SVL growth rate (mm/d) was significantly different between male and female lizards ($F_{`r overall_SVL_mod_anova$Df[4]`,`r overall_SVL_mod_anova$Df[6]`}$ = `r overall_SVL_mod_anova[4,3]`, p = `r p_value(overall_SVL_mod_anova[4,4])`). Where average SVL growth rate was `r overall_svl_growth_sex_mod_emm_cont[1,2]` mm/d higher than male lizards (±SE:`r overall_svl_growth_sex_mod_emm_cont[1,3]`, *t*-value = `r overall_svl_growth_sex_mod_emm_cont$t.ratio`, df = `r overall_svl_growth_sex_mod_emm_cont$df`, p = `r p_value(overall_svl_growth_sex_mod_emm_cont$p.value)`). SVL growth rate  was not affected by developmental environment of temperature ($F_{`r overall_SVL_mod_anova$Df[3]`,`r overall_SVL_mod_anova$Df[6]`}$ = `r overall_SVL_mod_anova[3,3]`, p = `r p_value(overall_SVL_mod_anova[3,4])`) or CORT developmental environment ($F_{`r overall_SVL_mod_anova$Df[2]`,`r overall_SVL_mod_anova$Df[6]`}$ = `r overall_SVL_mod_anova[2,3]`, p = `r p_value(overall_SVL_mod_anova[2,4])`). Body condition was estimated from final SVL and mass measurements and there were differences in body condition between sex ($F_{`r condition_juv3_mod_anova$Df[4]`,`r condition_juv3_mod_anova$Df[6]`}$ = `r condition_juv3_mod_anova[4,3]`, p = `r p_value(overall_SVL_mod_anova[4,4])`). Where on average, female body condition was `r condition_juv3_sex_mod_emm_cont[1,2]` higher than male lizards (±SE:`r condition_juv3_sex_mod_emm_cont[1,3]`, *t*-value = `r condition_juv3_sex_mod_emm_cont$t.ratio`, df = `r condition_juv3_sex_mod_emm_cont$df`, p = `r p_value(condition_juv3_sex_mod_emm_cont$p.value)`). Body condition was  not affected by developmental environment of temperature ($F_{`r condition_juv3_mod_anova$Df[2]`,`r condition_juv3_mod_anova$Df[6]`}$ = `r condition_juv3_mod_anova[2,3]`, p = `r p_value(condition_juv3_mod_anova[2,4])`) or CORT developmental environment ($F_{`r condition_juv3_mod_anova$Df[3]`,`r condition_juv3_mod_anova$Df[6]`}$ = `r condition_juv3_mod_anova[3,3]`, p = `r p_value(condition_juv3_mod_anova[3,4])`). A total of 15 lizards died during the duration of our study. However, survival frequency did not vary across CORT developmental environment (@fig-Figure_9 A; Kruskal-Wallis chi-squared = `r survival_results[1,3]`, df = 2, p=`r survival_results[1,4]`) or developmental temperature (@fig-Figure_9 B; Kruskal-Wallis chi-squared = `r survival_results[2,3]`, df = 1, p=`r survival_results[2,4]`). 
```{r, fig-Figure_9}
#| label: fig-Figure_9
#| fig-cap: "Survival frequency by developmental environment. Panel A are the frequencies by CORT developmental environment and panel B are by incubation environment."
#| echo: FALSE
#| warning: FALSE
#| fig-width: 10
#| fig-height: 7
#| fig-align: right
# Bring data for survival to end of study
data_final <- read.csv(here("Kwild_code/data/final_analysis_data.csv"))
# format data
survival<- data_final %>% 
  filter(liz_status_db != "MISSING") %>% 
  mutate(Temperature = as.character(temp)) %>% 
  rename(CORT = hormone)
survival_tbl <- table(survival$liz_status_db)

# hormone
survival_final_hormone <- survival %>% 
  group_by(liz_status_db, CORT) %>%
  summarise(n = n()) %>% 
  mutate(freq = n/sum(n))
# temperature 
survival_final_temp <- survival %>% 
  group_by(liz_status_db, Temperature) %>%
  summarise(n = n()) %>% 
  mutate(freq = n/sum(n))


### figures: 
# hormone
fig_survival_hormone <- ggplot(survival_final_hormone, aes(fill=CORT, y=freq, x=liz_status_db)) + 
  geom_bar(position="fill", stat="identity") +
  scale_fill_manual(values=c("#999999", "#E69F00", "brown2")) +
  ylab("% of survival") +
  xlab("Dead or Alive") +
  geom_text(aes(label=scales::percent(freq, accuracy = 1)), 
            position = position_fill(vjust = 0.5), 
            size = 5, fontface = "bold")+
  theme_bw()
# Temp
fig_survival_temp <- ggplot(survival_final_temp, aes(fill=Temperature, y=freq, x=liz_status_db)) + 
  geom_bar(position="fill", stat="identity") +
  scale_fill_manual(values=c("red", "blue")) +
  ylab("% of survival") +
  xlab("Dead or Alive") +
  geom_text(aes(label=scales::percent(freq, accuracy = 1)), 
            position = position_fill(vjust = 0.5), 
            size = 5, fontface = "bold")+
  theme_bw()

fig8 <- plot_grid(fig_survival_hormone, 
                  fig_survival_temp, ncol = 2, align = "h", labels = c("A", "B"))
fig8
```
